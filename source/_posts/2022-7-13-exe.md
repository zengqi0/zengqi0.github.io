---
title: 个人简历.exe
toc: true
date: 2022-07-13 09:12:38
tags:
categories: 恶意代码分析
---





# 前言

该样本运行后会遍历所有进程获取进程文件路径，以此来保证自身进程拥有足够权限执行后续行为。随后创建svchost傀儡进程，注入的代码通过解密自身资源节中编号为104的资源数据得到。解密后的数据为CobaltStrike载荷。

# 逆向分析及功能描述

**1.** **样本分析**

个人简历.exe为CobaltStrike加载器模块，其文件图标伪装为docx文档图标。

样本运行后会尝试遍历进程并获取进程的映像文件路径，以此保证自身进程拥有高权限。若权限不足则会由于无法获取映像文件路径而不执行后续功能。

![](2022-7-13-王庆松个人简历-exe/2.png)

若成功获取进程映像文件路径则表示权限充足，则休眠5秒后读取自身资源中编号为104的资源数据。

![](2022-7-13-王庆松个人简历-exe/3.png)

解密密钥字符串。

![](2022-7-13-王庆松个人简历-exe/4.png)

使用解密后的密钥解密104号资源数据。

![](2022-7-13-王庆松个人简历-exe/5.png)

解密后的数据为CobaltStrike载荷

![](2022-7-13-王庆松个人简历-exe/6.png)

随后创建“C:\\Windows\\System32\\svchost.exe”的傀儡进程，并通过插入APC的方式加载上文解密的CobaltStrike载荷。加载完成后，加载器进程将进入永久死循环

![](2022-7-13-王庆松个人简历-exe/7.png)

解密的载荷包含两个导出函数，分别为默认的DllMain与ReflectiveLoader。

![](2022-7-13-王庆松个人简历-exe/8.png)

其中DllMain代码为CobaltStrike实际功能载荷，而ReflectiveLoader用于修复自身进程导入表、重定位等信息以完成内存加载。

CobaltStrike载荷成功加载后会持续与“114.115.141.15:4431”进行通信以完成远控数据交互。

网络通信数据使用TLS V1进行加密。

![](2022-7-13-王庆松个人简历-exe/9.png)
