<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>进程和线程 | Hexo</title>
  <meta name="keywords" content="">
  <meta name="description" content="进程和线程 | Hexo">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="categories">
<meta property="og:url" content="http://example.com/categories/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-05-06T07:25:18.000Z">
<meta property="article:modified_time" content="2023-10-27T02:58:20.693Z">
<meta property="article:author" content="answer77">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.png">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.2.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.png"/>
</a>
<div class="author">
    <span>answer77</span>
</div>

<div class="icon">
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(88)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="安全开发">
                        
                        安全开发
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="安卓逆向">
                        <i class="fold iconfont icon-right"></i>
                        
                        安卓逆向
                        <small>(9)</small>
                        
                    </div>
                    
                        <ul class="sub hide">
                            
                                <li>
                                    <div data-rel="安卓逆向<--->入门手册">
                                        
                                        入门手册
                                        
                                            <small>(7
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                        </ul>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="恶意代码分析">
                        <i class="fold iconfont icon-right"></i>
                        
                        恶意代码分析
                        <small>(6)</small>
                        
                    </div>
                    
                        <ul class="sub hide">
                            
                                <li>
                                    <div data-rel="恶意代码分析<--->勒索病毒">
                                        
                                        勒索病毒
                                        
                                            <small>(1
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                                <li>
                                    <div data-rel="恶意代码分析<--->蠕虫">
                                        
                                        蠕虫
                                        
                                            <small>(2
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                        </ul>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="红队">
                        
                        红队
                        <small>(7)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="技术研究">
                        
                        技术研究
                        <small>(7)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
        
    
        
            
        
    
        
            
                <li>
                    <div data-rel="漏洞研究">
                        <i class="fold iconfont icon-right"></i>
                        
                        漏洞研究
                        <small>(3)</small>
                        
                    </div>
                    
                        <ul class="sub hide">
                            
                                <li>
                                    <div data-rel="漏洞研究<--->漏洞相关知识">
                                        
                                        漏洞相关知识
                                        
                                            <small>(1
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                        </ul>
                    
                </li>
            
        
    
        
            
        
    
        
            
        
    
        
            
                <li>
                    <div data-rel="软件逆向">
                        
                        软件逆向
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="渗透测试">
                        <i class="fold iconfont icon-right"></i>
                        
                        渗透测试
                        <small>(2)</small>
                        
                    </div>
                    
                        <ul class="sub hide">
                            
                                <li>
                                    <div data-rel="渗透测试<--->HTB">
                                        
                                        HTB
                                        
                                            <small>(2
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                        </ul>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="思想">
                        
                        思想
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="应急响应">
                        
                        应急响应
                        <small>(4)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="游戏逆向">
                        
                        游戏逆向
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
                <li>
                    <div data-rel="APT研究">
                        <i class="fold iconfont icon-right"></i>
                        
                        APT研究
                        <small>(7)</small>
                        
                    </div>
                    
                        <ul class="sub hide">
                            
                                <li>
                                    <div data-rel="APT研究<--->APT-C-08(蔓灵花)">
                                        
                                        APT-C-08(蔓灵花)
                                        
                                            <small>(1
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                                <li>
                                    <div data-rel="APT研究<--->APT-C-23(双尾蝎)">
                                        
                                        APT-C-23(双尾蝎)
                                        
                                            <small>(1
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                                <li>
                                    <div data-rel="APT研究<--->APT-C-26（Lazarus）">
                                        
                                        APT-C-26（Lazarus）
                                        
                                            <small>(1
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                                <li>
                                    <div data-rel="APT研究<--->APT-C-35(肚脑虫)">
                                        
                                        APT-C-35(肚脑虫)
                                        
                                            <small>(1
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                                <li>
                                    <div data-rel="APT研究<--->APT-C-48(CNC)">
                                        
                                        APT-C-48(CNC)
                                        
                                            <small>(1
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                                <li>
                                    <div data-rel="APT研究<--->APT-C-56(透明部落)">
                                        
                                        APT-C-56(透明部落)
                                        
                                            <small>(1
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                                <li>
                                    <div data-rel="APT研究<--->APT-Q-31(海莲花)">
                                        
                                        APT-Q-31(海莲花)
                                        
                                            <small>(1
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                        </ul>
                    
                </li>
            
        
    
        
            
        
    
        
            
                <li>
                    <div data-rel="HackTheBox">
                        <i class="fold iconfont icon-right"></i>
                        
                        HackTheBox
                        <small>(7)</small>
                        
                    </div>
                    
                        <ul class="sub hide">
                            
                                <li>
                                    <div data-rel="HackTheBox<--->Challenge">
                                        
                                        Challenge
                                        
                                            <small>(1
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                                <li>
                                    <div data-rel="HackTheBox<--->startpointer">
                                        
                                        startpointer
                                        
                                            <small>(1
                                                )</small>
                                        
                                    </div>
                                    
                                </li>
                            
                        </ul>
                    
                </li>
            
        
    
        
            
        
    
        
            
                <li>
                    <div data-rel="IOT">
                        
                        IOT
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
        
    
        
            
                <li>
                    <div data-rel="win内核">
                        
                        win内核
                        <small>(6)</small>
                        
                    </div>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="88">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a id="top" class="All 思想 "
           href="/2023/06/14/%E5%AF%B9%E4%B8%AD%E5%9B%BD%E6%95%B4%E4%B8%AA%E5%AE%89%E5%85%A8%E8%A1%8C%E4%B8%9A%E7%9A%84%E7%90%86%E8%A7%A3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="对中国整个安全行业的理解">对中国整个安全行业的理解</span>
            <span class="post-date" title="2023-06-14 16:06:36">2023/06/14</span>
        </a>
        
        
        <a  class="All "
           href="/2024/06/22/%E7%BA%A2%E9%98%9F%E6%89%93%E9%9D%B6%E4%B9%8BVulnHub-EvilBox/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="红队打靶之VulnHub_EvilBox">红队打靶之VulnHub_EvilBox</span>
            <span class="post-date" title="2024-06-22 09:55:56">2024/06/22</span>
        </a>
        
        
        <a  class="All "
           href="/2024/06/21/%E7%BA%A2%E9%98%9F%E6%89%93%E9%9D%B6%E4%B9%8BVulnHub-W1R3S/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="红队打靶之VulnHub_W1R3S">红队打靶之VulnHub_W1R3S</span>
            <span class="post-date" title="2024-06-21 20:35:00">2024/06/21</span>
        </a>
        
        
        <a  class="All "
           href="/2024/06/20/%E7%BA%A2%E9%98%9F%E6%89%93%E9%9D%B6%E4%B9%8BVulnHub-hard-socnet2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="红队打靶之VulnHub_hard_socnet2">红队打靶之VulnHub_hard_socnet2</span>
            <span class="post-date" title="2024-06-20 14:31:01">2024/06/20</span>
        </a>
        
        
        <a  class="All "
           href="/2024/06/20/%E7%BA%A2%E9%98%9F%E6%89%93%E9%9D%B6%E4%B9%8BVulnHub-AdmX-new/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="红队打靶之VulnHub_AdmX_new">红队打靶之VulnHub_AdmX_new</span>
            <span class="post-date" title="2024-06-20 08:40:02">2024/06/20</span>
        </a>
        
        
        <a  class="All "
           href="/2024/06/18/%E7%BA%A2%E9%98%9F%E6%89%93%E9%9D%B6%E4%B9%8BVulnHub-CHRONOS-1/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="红队打靶之VulnHub_CHRONOS_1">红队打靶之VulnHub_CHRONOS_1</span>
            <span class="post-date" title="2024-06-18 17:16:48">2024/06/18</span>
        </a>
        
        
        <a  class="All "
           href="/2024/06/18/%E7%BA%A2%E9%98%9F%E6%89%93%E9%9D%B6%E4%B9%8BVulnHub-BOREDHACKERBLOG-%E4%BA%91-AV/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="红队打靶之VulnHub_BOREDHACKERBLOG_云_AV">红队打靶之VulnHub_BOREDHACKERBLOG_云_AV</span>
            <span class="post-date" title="2024-06-18 11:18:34">2024/06/18</span>
        </a>
        
        
        <a  class="All 红队 "
           href="/2024/06/17/%E7%BA%A2%E9%98%9F%E6%89%93%E9%9D%B6%E4%B9%8BVulnHub-BOREDHACKERBLOG-SOCIAL-NETWORK/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="红队打靶之VulnHub_BOREDHACKERBLOG_SOCIAL_NETWORK">红队打靶之VulnHub_BOREDHACKERBLOG_SOCIAL_NETWORK</span>
            <span class="post-date" title="2024-06-17 21:52:00">2024/06/17</span>
        </a>
        
        
        <a  class="All "
           href="/2023/09/07/Apache%20HTTP%20Server%20%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E6%BC%8F%E6%B4%9E%20CVE-2023-25690/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Apache HTTP Server 请求走私漏洞 CVE-2023-25690">Apache HTTP Server 请求走私漏洞 CVE-2023-25690</span>
            <span class="post-date" title="2023-09-07 16:12:59">2023/09/07</span>
        </a>
        
        
        <a  class="All "
           href="/2023/09/06/BurpSuite%E5%AD%A6%E4%B9%A0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BurpSuite学习">BurpSuite学习</span>
            <span class="post-date" title="2023-09-06 15:34:11">2023/09/06</span>
        </a>
        
        
        <a  class="All "
           href="/2023/08/01/DVWA%E4%B9%8BSQL%20Injection%20Snort%E8%A7%84%E5%88%99%E6%8F%90%E5%8F%96/"
           data-tag=""
           data-author="" >
            <span class="post-title" title=""></span>
            <span class="post-date" title="2023-08-01 09:43:02">2023/08/01</span>
        </a>
        
        
        <a  class="All "
           href="/2023/07/31/%E8%AF%9D%E6%9C%AF/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="话术">话术</span>
            <span class="post-date" title="2023-07-31 14:46:46">2023/07/31</span>
        </a>
        
        
        <a  class="All 安全开发 "
           href="/2023/07/24/%E6%81%B6%E6%84%8F%E6%B5%81%E9%87%8F%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="恶意流量系统开发">恶意流量系统开发</span>
            <span class="post-date" title="2023-07-24 16:46:05">2023/07/24</span>
        </a>
        
        
        <a  class="All "
           href="/2023/07/24/%E5%90%8E%E9%97%A8%E5%BC%80%E5%8F%91/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="后门开发">后门开发</span>
            <span class="post-date" title="2023-07-24 10:15:44">2023/07/24</span>
        </a>
        
        
        <a  class="All 安全开发 "
           href="/2023/07/21/%E6%89%AB%E6%8F%8F%E5%99%A8%E5%BC%80%E5%8F%91/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="tcp端口扫描器">tcp端口扫描器</span>
            <span class="post-date" title="2023-07-21 09:25:02">2023/07/21</span>
        </a>
        
        
        <a  class="All 红队 "
           href="/2023/07/19/%E6%8C%81%E4%B9%85%E5%8C%96/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="持久化">持久化</span>
            <span class="post-date" title="2023-07-19 16:46:54">2023/07/19</span>
        </a>
        
        
        <a  class="All "
           href="/2023/07/17/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%8C%E6%95%B4%E5%AD%A6%E4%B9%A0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Mysql数据库完整学习">Mysql数据库完整学习</span>
            <span class="post-date" title="2023-07-17 16:03:05">2023/07/17</span>
        </a>
        
        
        <a  class="All 红队 "
           href="/2023/07/17/%E9%98%B2%E5%BE%A1%E8%A7%84%E9%81%BF/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="防御规避">防御规避</span>
            <span class="post-date" title="2023-07-17 14:22:21">2023/07/17</span>
        </a>
        
        
        <a  class="All 红队 "
           href="/2023/07/17/%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="代码执行">代码执行</span>
            <span class="post-date" title="2023-07-17 10:27:01">2023/07/17</span>
        </a>
        
        
        <a  class="All 红队 "
           href="/2023/07/14/%E5%88%9D%E5%A7%8B%E8%AE%BF%E9%97%AE/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="初始访问">初始访问</span>
            <span class="post-date" title="2023-07-14 16:10:59">2023/07/14</span>
        </a>
        
        
        <a  class="All 红队 "
           href="/2023/07/14/%E4%BB%A3%E7%A0%81%E4%B8%8E%E8%BF%9B%E7%A8%8B%E6%B3%A8%E5%85%A5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="代码与进程注入">代码与进程注入</span>
            <span class="post-date" title="2023-07-14 09:41:04">2023/07/14</span>
        </a>
        
        
        <a  class="All "
           href="/2023/07/11/python%E9%BB%91%E5%AE%A2%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%BC%96%E7%A8%8B%E4%B9%8B%E9%81%93/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="python黑客渗透测试编程之道">python黑客渗透测试编程之道</span>
            <span class="post-date" title="2023-07-11 10:54:54">2023/07/11</span>
        </a>
        
        
        <a  class="All 红队 "
           href="/2023/07/11/%E7%BA%A2%E9%98%9F%E6%80%9D%E8%B7%AF/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="红队思路">红队思路</span>
            <span class="post-date" title="2023-07-11 10:43:16">2023/07/11</span>
        </a>
        
        
        <a  class="All "
           href="/2023/06/30/go%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="go语言入门">go语言入门</span>
            <span class="post-date" title="2023-06-30 16:46:48">2023/06/30</span>
        </a>
        
        
        <a  class="All HackTheBox "
           href="/2023/06/28/htb%E5%AD%A6%E9%99%A2%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="htb学院文件包含">htb学院文件包含</span>
            <span class="post-date" title="2023-06-28 16:17:24">2023/06/28</span>
        </a>
        
        
        <a  class="All HackTheBox "
           href="/2023/06/28/htb%E5%AD%A6%E9%99%A2%E4%BD%BF%E7%94%A8%20FFUF%20%E6%94%BB%E5%87%BB%20WEB%20%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="应用程序">应用程序</span>
            <span class="post-date" title="2023-06-28 16:14:55">2023/06/28</span>
        </a>
        
        
        <a  class="All "
           href="/2023/06/28/htb%E5%AD%A6%E9%99%A2linux%E5%9F%BA%E7%A1%80/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="htb学院 htb学院linux基础">htb学院 htb学院linux基础</span>
            <span class="post-date" title="2023-06-28 16:13:26">2023/06/28</span>
        </a>
        
        
        <a  class="All "
           href="/2023/06/28/htb%E5%AD%A6%E9%99%A2sql%E6%B3%A8%E5%85%A5%E5%9F%BA%E7%A1%80/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="htb学院htb学院sql注入基础">htb学院htb学院sql注入基础</span>
            <span class="post-date" title="2023-06-28 16:11:22">2023/06/28</span>
        </a>
        
        
        <a  class="All APT研究 APT-Q-31(海莲花) "
           href="/2023/06/14/APT-Q-31(%E6%B5%B7%E8%8E%B2%E8%8A%B1)%E6%97%B6%E9%97%B4%E7%BA%BF%E5%8F%8A%E6%94%BB%E5%87%BB%E6%89%8B%E6%B3%95%E6%80%BB%E7%BB%93/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="APT-Q-31(海莲花)时间线及攻击手法总结">APT-Q-31(海莲花)时间线及攻击手法总结</span>
            <span class="post-date" title="2023-06-14 17:00:06">2023/06/14</span>
        </a>
        
        
        <a  class="All "
           href="/2023/06/08/Gophish%E9%92%93%E9%B1%BC%E5%B9%B3%E5%8F%B0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Gophish钓鱼平台">Gophish钓鱼平台</span>
            <span class="post-date" title="2023-06-08 15:05:05">2023/06/08</span>
        </a>
        
        
        <a  class="All "
           href="/2023/06/08/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%A5%E9%97%A8-%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E7%AF%87/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="应急响应入门-入侵排查篇">应急响应入门-入侵排查篇</span>
            <span class="post-date" title="2023-06-08 15:05:05">2023/06/08</span>
        </a>
        
        
        <a  class="All 思想 "
           href="/2023/06/05/%E8%AE%BA%E6%96%B0%E4%B8%AD%E5%9B%BD%E6%88%90%E7%AB%8B%E4%BB%A5%E6%9D%A5%E7%BB%8F%E6%B5%8E%E5%8D%B1%E6%9C%BA/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="论新中国成立以来经济危机">论新中国成立以来经济危机</span>
            <span class="post-date" title="2023-06-05 15:27:21">2023/06/05</span>
        </a>
        
        
        <a  class="All 渗透测试 HTB "
           href="/2023/04/25/windows%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="windows基础知识">windows基础知识</span>
            <span class="post-date" title="2023-04-25 15:08:28">2023/04/25</span>
        </a>
        
        
        <a  class="All 渗透测试 HTB "
           href="/2023/04/23/%E4%BD%BF%E7%94%A8METASPLOIT%E6%A1%86%E6%9E%B6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="使用METASPLOIT框架">使用METASPLOIT框架</span>
            <span class="post-date" title="2023-04-23 16:53:53">2023/04/23</span>
        </a>
        
        
        <a  class="All HackTheBox "
           href="/2023/03/13/Crypto/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Crypto">Crypto</span>
            <span class="post-date" title="2023-03-13 17:04:01">2023/03/13</span>
        </a>
        
        
        <a  class="All HackTheBox "
           href="/2023/03/11/machine/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="machine">machine</span>
            <span class="post-date" title="2023-03-11 17:47:30">2023/03/11</span>
        </a>
        
        
        <a  class="All HackTheBox Challenge "
           href="/2023/03/10/Forensics%20Collection/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Forensics Collection">Forensics Collection</span>
            <span class="post-date" title="2023-03-10 15:15:04">2023/03/10</span>
        </a>
        
        
        <a  class="All HackTheBox "
           href="/2023/03/09/Reminiscent/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Reminiscent">Reminiscent</span>
            <span class="post-date" title="2023-03-09 09:41:42">2023/03/09</span>
        </a>
        
        
        <a  class="All HackTheBox startpointer "
           href="/2023/03/08/HackTheBox%E4%B8%8A%E5%88%86%E9%94%A6%E5%9B%8A/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="HackTheBox上分锦囊(一)">HackTheBox上分锦囊(一)</span>
            <span class="post-date" title="2023-03-08 13:55:09">2023/03/08</span>
        </a>
        
        
        <a  class="All "
           href="/2023/02/27/%E8%AE%B0%E4%B8%80%E6%AC%A1Kaiji%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="记一次Kaiji僵尸网络">记一次Kaiji僵尸网络</span>
            <span class="post-date" title="2023-02-27 17:16:34">2023/02/27</span>
        </a>
        
        
        <a  class="All 漏洞研究 "
           href="/2023/02/24/cve2012-0158%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cve2012-0158漏洞复现">cve2012-0158漏洞复现</span>
            <span class="post-date" title="2023-02-24 16:43:56">2023/02/24</span>
        </a>
        
        
        <a  class="All 技术研究 "
           href="/2023/02/22/PowerShell%E5%9F%BA%E7%A1%80/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="PowerShell基础">PowerShell基础</span>
            <span class="post-date" title="2023-02-22 11:46:25">2023/02/22</span>
        </a>
        
        
        <a  class="All APT研究 APT-C-48(CNC) "
           href="/2023/02/20/APT-C-48-CNC%E7%BB%84%E7%BB%87%E6%94%BB%E5%87%BB%E5%88%A9%E7%94%A8pub%E6%96%87%E4%BB%B6%E6%94%BB%E5%87%BB%E6%B4%BB%E5%8A%A8%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="APT-C-48-CNC组织攻击利用pub文件攻击活动分析">APT-C-48-CNC组织攻击利用pub文件攻击活动分析</span>
            <span class="post-date" title="2023-02-20 14:10:47">2023/02/20</span>
        </a>
        
        
        <a  class="All "
           href="/2023/02/14/APT-C-56-%E9%80%8F%E6%98%8E%E9%83%A8%E8%90%BD%E4%BC%AA%E8%A3%85%E7%AE%80%E5%8E%86%E6%94%BB%E5%87%BB%E6%B4%BB%E5%8A%A8%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="APT-C-56-透明部落伪装简历攻击活动分析">APT-C-56-透明部落伪装简历攻击活动分析</span>
            <span class="post-date" title="2023-02-14 16:08:03">2023/02/14</span>
        </a>
        
        
        <a  class="All APT研究 APT-C-35(肚脑虫) "
           href="/2023/02/11/APT-C-35%E8%82%9A%E8%84%91%E8%99%AB%E6%9F%90%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E4%B8%80/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="APT-C-35肚脑虫某样本分析(一)">APT-C-35肚脑虫某样本分析(一)</span>
            <span class="post-date" title="2023-02-11 18:13:48">2023/02/11</span>
        </a>
        
        
        <a  class="All 应急响应 "
           href="/2023/02/09/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="应急响应入门指南">应急响应入门指南</span>
            <span class="post-date" title="2023-02-09 13:37:00">2023/02/09</span>
        </a>
        
        
        <a  class="All APT研究 APT-C-56(透明部落) "
           href="/2023/02/06/APT-C-56%EF%BC%88%E9%80%8F%E6%98%8E%E9%83%A8%E8%90%BD%EF%BC%89%E5%88%A9%E7%94%A8%E5%A4%96%E8%B4%B8%E9%93%BE%E6%8E%A5%E4%BC%AA%E8%A3%85%E6%96%87%E6%A1%A3%E6%94%BB%E5%87%BB%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="APT-C-56（透明部落）利用外贸链接伪装文档攻击分析">APT-C-56（透明部落）利用外贸链接伪装文档攻击分析</span>
            <span class="post-date" title="2023-02-06 18:13:48">2023/02/06</span>
        </a>
        
        
        <a  class="All 恶意代码分析 "
           href="/2022/11/27/%E5%A4%A7%E7%81%B0%E7%8B%BC%E8%BF%9C%E6%8E%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="大灰狼远控">大灰狼远控</span>
            <span class="post-date" title="2022-11-27 21:35:19">2022/11/27</span>
        </a>
        
        
        <a  class="All 软件逆向 "
           href="/2022/11/27/peid%E9%80%86%E5%90%91/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="peid逆向">peid逆向</span>
            <span class="post-date" title="2022-11-27 10:15:30">2022/11/27</span>
        </a>
        
        
        <a  class="All win内核 "
           href="/2022/11/19/windbg%E5%91%BD%E4%BB%A4%E5%AD%A6%E4%B9%A0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="windbg命令学习">windbg命令学习</span>
            <span class="post-date" title="2022-11-19 22:31:27">2022/11/19</span>
        </a>
        
        
        <a  class="All win内核 "
           href="/2022/11/19/%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="进程和线程">进程和线程</span>
            <span class="post-date" title="2022-11-19 20:42:28">2022/11/19</span>
        </a>
        
        
        <a  class="All win内核 "
           href="/2022/11/15/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="保护模式">保护模式</span>
            <span class="post-date" title="2022-11-15 15:35:26">2022/11/15</span>
        </a>
        
        
        <a  class="All win内核 "
           href="/2022/11/14/winX86%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="winX86内核驱动开发">winX86内核驱动开发</span>
            <span class="post-date" title="2022-11-14 16:22:58">2022/11/14</span>
        </a>
        
        
        <a  class="All win内核 "
           href="/2022/11/13/%E5%86%85%E6%A0%B8%E5%AD%A6%E4%B9%A0%E5%8F%8C%E6%9C%BA%E8%B0%83%E8%AF%95/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="内核环境搭建学习">内核环境搭建学习</span>
            <span class="post-date" title="2022-11-13 15:05:11">2022/11/13</span>
        </a>
        
        
        <a  class="All 游戏逆向 "
           href="/2022/11/07/%E7%83%AD%E8%A1%80%E6%B1%9F%E6%B9%96%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%AD%91%E5%9F%BA/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="热血江湖游戏安全筑基">热血江湖游戏安全筑基</span>
            <span class="post-date" title="2022-11-07 21:27:59">2022/11/07</span>
        </a>
        
        
        <a  class="All 安卓逆向 入门手册 "
           href="/2022/09/29/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E4%B9%8BAPK%E4%BF%9D%E6%8A%A4%E7%AD%96%E7%95%A5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="APK反破解技术">APK反破解技术</span>
            <span class="post-date" title="2022-09-29 16:55:42">2022/09/29</span>
        </a>
        
        
        <a  class="All 安卓逆向 "
           href="/2022/09/29/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E4%B9%8BXposed%E6%A1%86%E6%9E%B6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="安卓逆向之Xposed框架">安卓逆向之Xposed框架</span>
            <span class="post-date" title="2022-09-29 14:53:11">2022/09/29</span>
        </a>
        
        
        <a  class="All 安卓逆向 入门手册 "
           href="/2022/09/29/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E4%B9%8BNDK%E5%BC%80%E5%8F%91/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="NDK开发">NDK开发</span>
            <span class="post-date" title="2022-09-29 14:42:34">2022/09/29</span>
        </a>
        
        
        <a  class="All 安卓逆向 "
           href="/2022/09/27/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98%E4%BF%AE%E6%94%B9%E8%B5%84%E6%BA%90%E5%8E%BB%E5%B9%BF%E5%91%8A01/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="安卓逆向实战修改资源去广告01">安卓逆向实战修改资源去广告01</span>
            <span class="post-date" title="2022-09-27 19:46:34">2022/09/27</span>
        </a>
        
        
        <a  class="All 安卓逆向 入门手册 "
           href="/2022/09/26/%E9%80%9A%E8%BF%87%E5%AE%9E%E6%88%98%E5%AD%A6%E4%B9%A0smali%E6%B1%87%E7%BC%96/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="smali与dalvik指令">smali与dalvik指令</span>
            <span class="post-date" title="2022-09-26 15:50:15">2022/09/26</span>
        </a>
        
        
        <a  class="All 安卓逆向 入门手册 "
           href="/2022/09/23/%E5%9F%BA%E4%BA%8EAndroid%E7%9A%84ARM%E6%B1%87%E7%BC%96/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="基于Android的ARM汇编">基于Android的ARM汇编</span>
            <span class="post-date" title="2022-09-23 15:17:52">2022/09/23</span>
        </a>
        
        
        <a  class="All 安卓逆向 入门手册 "
           href="/2022/09/21/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E4%B9%8BAPK%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="安卓逆向之APK打包流程">安卓逆向之APK打包流程</span>
            <span class="post-date" title="2022-09-21 10:17:44">2022/09/21</span>
        </a>
        
        
        <a  class="All 安卓逆向 入门手册 "
           href="/2022/09/19/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E4%B9%8B%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="安卓逆向之安卓开发">安卓逆向之安卓开发</span>
            <span class="post-date" title="2022-09-19 17:18:12">2022/09/19</span>
        </a>
        
        
        <a  class="All 安卓逆向 入门手册 "
           href="/2022/09/16/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E4%B9%8Bjava%E5%9F%BA%E7%A1%80/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="安卓逆向之java基础">安卓逆向之java基础</span>
            <span class="post-date" title="2022-09-16 18:02:04">2022/09/16</span>
        </a>
        
        
        <a  class="All IOT "
           href="/2022/09/01/IOT%E5%88%9D%E6%8E%A2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="iot初探">iot初探</span>
            <span class="post-date" title="2022-09-01 14:51:06">2022/09/01</span>
        </a>
        
        
        <a  class="All 漏洞研究 漏洞相关知识 "
           href="/2022/09/01/win%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E5%8E%9F%E7%90%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="漏洞利用原理">漏洞利用原理</span>
            <span class="post-date" title="2022-09-01 11:16:25">2022/09/01</span>
        </a>
        
        
        <a  class="All 漏洞研究 "
           href="/2022/08/31/CVE-2010-2883%E5%A4%8D%E7%8E%B0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CVE-2010-2883_Adobe Reader TTF字体SING表栈溢出漏洞复现">CVE-2010-2883_Adobe Reader TTF字体SING表栈溢出漏洞复现</span>
            <span class="post-date" title="2022-08-31 17:35:30">2022/08/31</span>
        </a>
        
        
        <a  class="All "
           href="/2022/08/23/APT_Shamoon/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="关于Shamoon.APT组织的一次完整攻击链分析">关于Shamoon.APT组织的一次完整攻击链分析</span>
            <span class="post-date" title="2022-08-23 10:12:17">2022/08/23</span>
        </a>
        
        
        <a  class="All 应急响应 "
           href="/2022/08/16/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="日志分析">日志分析</span>
            <span class="post-date" title="2022-08-16 17:04:55">2022/08/16</span>
        </a>
        
        
        <a  class="All 应急响应 "
           href="/2022/08/16/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94everything%E6%96%87%E4%BB%B6%E8%BF%87%E6%BB%A4/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="everything文件过滤">everything文件过滤</span>
            <span class="post-date" title="2022-08-16 16:22:03">2022/08/16</span>
        </a>
        
        
        <a  class="All APT研究 APT-C-26（Lazarus） "
           href="/2022/08/12/Lazarus%E4%B8%80%E6%AC%A1%E9%92%88%E5%AF%B9%E8%88%AA%E7%A9%BA%E8%88%AA%E5%A4%A9%E8%A1%8C%E4%B8%9A%E7%9A%84%E6%94%BB%E5%87%BB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lazarus一次针对航空航天行业的攻击">Lazarus一次针对航空航天行业的攻击</span>
            <span class="post-date" title="2022-08-12 15:02:59">2022/08/12</span>
        </a>
        
        
        <a  class="All APT研究 APT-C-08(蔓灵花) "
           href="/2022/08/11/BITTER%E7%BB%84%E7%BB%87%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%901/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BITTER组织样本分析1">BITTER组织样本分析1</span>
            <span class="post-date" title="2022-08-11 16:06:21">2022/08/11</span>
        </a>
        
        
        <a  class="All 技术研究 "
           href="/2022/07/19/%E7%88%AC%E8%99%AB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="爬虫">爬虫</span>
            <span class="post-date" title="2022-07-19 16:12:19">2022/07/19</span>
        </a>
        
        
        <a  class="All "
           href="/2022/07/15/Google_Hacking_%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Google_Hacking_谷歌搜索引擎">Google_Hacking_谷歌搜索引擎</span>
            <span class="post-date" title="2022-07-15 09:56:40">2022/07/15</span>
        </a>
        
        
        <a  class="All 恶意代码分析 "
           href="/2022/07/13/2022-7-13-exe/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="个人简历.exe">个人简历.exe</span>
            <span class="post-date" title="2022-07-13 09:12:38">2022/07/13</span>
        </a>
        
        
        <a  class="All 技术研究 "
           href="/2022/07/06/%E5%88%9D%E5%85%A5Yara/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Yara入门">Yara入门</span>
            <span class="post-date" title="2022-07-06 16:14:17">2022/07/06</span>
        </a>
        
        
        <a  class="All 恶意代码分析 蠕虫 "
           href="/2022/06/28/2022-06-25_Scar%E6%84%9F%E6%9F%93%E5%BC%8F%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="2022.06.25_Scar感染式样本分析">2022.06.25_Scar感染式样本分析</span>
            <span class="post-date" title="2022-06-28 09:25:02">2022/06/28</span>
        </a>
        
        
        <a  class="All "
           href="/2022/06/27/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%89%8B%E5%86%8C/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="应急响应手册">应急响应手册</span>
            <span class="post-date" title="2022-06-27 15:20:12">2022/06/27</span>
        </a>
        
        
        <a  class="All 恶意代码分析 "
           href="/2022/03/08/%E5%AE%8F%E7%97%85%E6%AF%92%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="宏病毒基础入门">宏病毒基础入门</span>
            <span class="post-date" title="2022-03-08 09:23:03">2022/03/08</span>
        </a>
        
        
        <a  class="All 恶意代码分析 勒索病毒 "
           href="/2022/03/07/WannaCry%E7%97%85%E6%AF%92%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="WannaCry病毒分析">WannaCry病毒分析</span>
            <span class="post-date" title="2022-03-07 11:40:13">2022/03/07</span>
        </a>
        
        
        <a  class="All 技术研究 "
           href="/2022/03/03/wireshark/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="wireshark">wireshark</span>
            <span class="post-date" title="2022-03-03 12:18:53">2022/03/03</span>
        </a>
        
        
        <a  class="All APT研究 APT-C-23(双尾蝎) "
           href="/2022/02/27/%E5%8F%8C%E5%B0%BE%E8%9D%8E%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="APT-C-23境外双尾蝎组织样本分析">APT-C-23境外双尾蝎组织样本分析</span>
            <span class="post-date" title="2022-02-27 16:00:07">2022/02/27</span>
        </a>
        
        
        <a  class="All 应急响应 "
           href="/2022/02/24/%E8%AE%B0%E5%BD%95%E6%A0%A1%E5%9B%ADMAC%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="记录校园MAC挖矿病毒">记录校园MAC挖矿病毒</span>
            <span class="post-date" title="2022-02-24 20:04:18">2022/02/24</span>
        </a>
        
        
        <a  class="All 恶意代码分析 蠕虫 "
           href="/2022/02/24/%E7%86%8A%E7%8C%AB%E7%83%A7%E9%A6%99%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="熊猫烧香分析">熊猫烧香分析</span>
            <span class="post-date" title="2022-02-24 18:09:42">2022/02/24</span>
        </a>
        
        
        <a  class="All win内核 "
           href="/2022/02/20/win%E5%86%85%E6%A0%B8%E4%B8%8E%E9%A9%B1%E5%8A%A8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="win内核与驱动">win内核与驱动</span>
            <span class="post-date" title="2022-02-20 08:23:51">2022/02/20</span>
        </a>
        
        
        <a  class="All 技术研究 "
           href="/2022/01/28/PE/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="PE">PE</span>
            <span class="post-date" title="2022-01-28 21:26:29">2022/01/28</span>
        </a>
        
        
        <a  class="All 技术研究 "
           href="/2021/04/10/unix%E7%8E%AF%E5%A2%83%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="unix环境高级编程">unix环境高级编程</span>
            <span class="post-date" title="2021-04-10 14:54:25">2021/04/10</span>
        </a>
        
        
        <a  class="All 技术研究 "
           href="/2021/03/29/codeql%E5%88%9D%E5%85%A5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="codeql初入">codeql初入</span>
            <span class="post-date" title="2021-03-29 14:14:01">2021/03/29</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-进程和线程" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">进程和线程</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="win内核">win内核</a>
            
        </span>
        
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2023-10-27 10:58:22'>2022-11-19 20:42</time>
        
    </div>
    <div class="article-meta">
        
        
        <span id="busuanzi_container_page_pv">
            Views 👀 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-KPCR%E7%BB%93%E6%9E%84"><span class="toc-text">1.KPCR结构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#KPRCB%E7%BB%93%E6%9E%84"><span class="toc-text">KPRCB结构</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-EPROCESS%E7%BB%93%E6%9E%84"><span class="toc-text">2.EPROCESS结构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#KPROCESS%E7%BB%93%E6%9E%84"><span class="toc-text">KPROCESS结构</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-ETHREAD%E7%BB%93%E6%9E%84"><span class="toc-text">3.ETHREAD结构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#KTHREAD%E7%BB%93%E6%9E%84"><span class="toc-text">KTHREAD结构</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-OBJECT-HEADER"><span class="toc-text">4.OBJECT_HEADER</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E7%BA%BF%E7%A8%8B%E9%93%BE%E8%A1%A8"><span class="toc-text">5.线程链表</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%89%E5%BE%85%E9%93%BE%E8%A1%A8"><span class="toc-text">等待链表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%B1%E7%BB%AA%E9%93%BE%E8%A1%A8%EF%BC%88%E8%B0%83%E5%BA%A6%E9%93%BE%E8%A1%A8%EF%BC%89"><span class="toc-text">就绪链表（调度链表）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%EF%BC%9A%E8%BF%9B%E7%A8%8B%E3%80%81%E7%BA%BF%E7%A8%8B%E9%81%8D%E5%8E%86"><span class="toc-text">扩展：进程、线程遍历</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E7%BA%BF%E7%A8%8B%E5%88%87%E6%8D%A2-%E6%A8%A1%E6%8B%9F%E7%89%88"><span class="toc-text">6.线程切换-模拟版</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RegisterGMThread"><span class="toc-text">RegisterGMThread</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-6 i,
    .toc-level-6 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1-KPCR结构"><a href="#1-KPCR结构" class="headerlink" title="1.KPCR结构"></a>1.KPCR结构</h1><p>CPU控制块结构，每一个逻辑核都有一个KPCR结构描述当前CPU的各种信息。全局变量“KeNumberProcessors”中保存了当前机器的CPU核数。</p>
<p>在系统调用章节我们初步了解了KPCR的部分成员。</p>
<p>KPCR结构成员列表：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//0x3748 bytes (sizeof)</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">KPCR</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> _<span class="title">NT_TIB</span> <span class="title">NtTib</span>;</span>                                               <span class="comment">//0x0</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            <span class="class"><span class="keyword">struct</span> _<span class="title">EXCEPTION_REGISTRATION_RECORD</span>* <span class="title">Used_ExceptionList</span>;</span>      <span class="comment">//0x0</span></span><br><span class="line">            VOID* Used_StackBase;                                           <span class="comment">//0x4</span></span><br><span class="line">            VOID* Spare2;                                                   <span class="comment">//0x8</span></span><br><span class="line">            VOID* TssCopy;                                                  <span class="comment">//0xc</span></span><br><span class="line">            ULONG ContextSwitches;                                          <span class="comment">//0x10</span></span><br><span class="line">            ULONG SetMemberCopy;                                            <span class="comment">//0x14</span></span><br><span class="line">            VOID* Used_Self;                                                <span class="comment">//0x18</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KPCR</span>* <span class="title">SelfPcr</span>;</span>                                                  <span class="comment">//0x1c</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KPRCB</span>* <span class="title">Prcb</span>;</span>                                                    <span class="comment">//0x20</span></span><br><span class="line">    UCHAR Irql;                                                             <span class="comment">//0x24</span></span><br><span class="line">    ULONG IRR;                                                              <span class="comment">//0x28</span></span><br><span class="line">    ULONG IrrActive;                                                        <span class="comment">//0x2c</span></span><br><span class="line">    ULONG IDR;                                                              <span class="comment">//0x30</span></span><br><span class="line">    VOID* KdVersionBlock;                                                   <span class="comment">//0x34</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KIDTENTRY</span>* <span class="title">IDT</span>;</span>                                                 <span class="comment">//0x38</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KGDTENTRY</span>* <span class="title">GDT</span>;</span>                                                 <span class="comment">//0x3c</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KTSS</span>* <span class="title">TSS</span>;</span>                                                      <span class="comment">//0x40</span></span><br><span class="line">    USHORT MajorVersion;                                                    <span class="comment">//0x44</span></span><br><span class="line">    USHORT MinorVersion;                                                    <span class="comment">//0x46</span></span><br><span class="line">    ULONG SetMember;                                                        <span class="comment">//0x48</span></span><br><span class="line">    ULONG StallScaleFactor;                                                 <span class="comment">//0x4c</span></span><br><span class="line">    UCHAR SpareUnused;                                                      <span class="comment">//0x50</span></span><br><span class="line">    UCHAR Number;                                                           <span class="comment">//0x51</span></span><br><span class="line">    UCHAR Spare0;                                                           <span class="comment">//0x52</span></span><br><span class="line">    UCHAR SecondLevelCacheAssociativity;                                    <span class="comment">//0x53</span></span><br><span class="line">    ULONG VdmAlert;                                                         <span class="comment">//0x54</span></span><br><span class="line">    ULONG KernelReserved[<span class="number">14</span>];                                               <span class="comment">//0x58</span></span><br><span class="line">    ULONG SecondLevelCacheSize;                                             <span class="comment">//0x90</span></span><br><span class="line">    ULONG HalReserved[<span class="number">16</span>];                                                  <span class="comment">//0x94</span></span><br><span class="line">    ULONG InterruptMode;                                                    <span class="comment">//0xd4</span></span><br><span class="line">    UCHAR Spare1;                                                           <span class="comment">//0xd8</span></span><br><span class="line">    ULONG KernelReserved2[<span class="number">17</span>];                                              <span class="comment">//0xdc</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KPRCB</span> <span class="title">PrcbData</span>;</span>                                                 <span class="comment">//0x120</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>+0 NtTib：<ul>
<li>+0 Used_ExceptionList：异常处理程序链表。</li>
<li>+4 Used_StackBase：当前线程的栈底。</li>
<li>+8 Spare2&#x2F;StackLimit：当前线程的堆栈大小。</li>
<li>+18 Used_Self：指向NtTib自身，也是KPCR自身（fs:[0x18]）。</li>
</ul>
</li>
<li>+1C SelfPcr：指向KPCR自身。与UsedSelf不同，SelfPcr必然指向KPCR自身，UsedSelf有时候会指向TEB。</li>
<li>+20 Prcb：KPRCB结构指针。见后文。</li>
<li>+38 IDT：当前线程的IDT表地址。</li>
<li>+3C GDT：当前线程的GDT表地址。</li>
<li>+40 TSS：指向当前线程的TSS表。</li>
<li>+48 SetNumber：当前CPU编号。从1开始。</li>
<li>+51 Number：当前CPU编号。从0开始。</li>
<li>+120 PrcbData：KPRCB结构，扩展结构，见后文。</li>
</ul>
<h2 id="KPRCB结构"><a href="#KPRCB结构" class="headerlink" title="KPRCB结构"></a>KPRCB结构</h2><p>CPU控制块扩展块。全局变量“KiProcessorBlock”中保存了KPRCB的地址。</p>
<p>KPRCB结构成员列表：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//0x3628 bytes (sizeof)</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">KPRCB</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    USHORT MinorVersion;                                                    <span class="comment">//0x0</span></span><br><span class="line">    USHORT MajorVersion;                                                    <span class="comment">//0x2</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KTHREAD</span>* <span class="title">CurrentThread</span>;</span>                                         <span class="comment">//0x4</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KTHREAD</span>* <span class="title">NextThread</span>;</span>                                            <span class="comment">//0x8</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KTHREAD</span>* <span class="title">IdleThread</span>;</span>                                            <span class="comment">//0xc</span></span><br><span class="line">    UCHAR LegacyNumber;                                                     <span class="comment">//0x10</span></span><br><span class="line">    UCHAR NestingLevel;                                                     <span class="comment">//0x11</span></span><br><span class="line">    USHORT BuildType;                                                       <span class="comment">//0x12</span></span><br><span class="line">    CHAR CpuType;                                                           <span class="comment">//0x14</span></span><br><span class="line">    CHAR CpuID;                                                             <span class="comment">//0x15</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        USHORT CpuStep;                                                     <span class="comment">//0x16</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            UCHAR CpuStepping;                                              <span class="comment">//0x16</span></span><br><span class="line">            UCHAR CpuModel;                                                 <span class="comment">//0x17</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KPROCESSOR_STATE</span> <span class="title">ProcessorState</span>;</span>                                <span class="comment">//0x18</span></span><br><span class="line">    ULONG KernelReserved[<span class="number">16</span>];                                               <span class="comment">//0x338</span></span><br><span class="line">    ULONG HalReserved[<span class="number">16</span>];                                                  <span class="comment">//0x378</span></span><br><span class="line">    ULONG CFlushSize;                                                       <span class="comment">//0x3b8</span></span><br><span class="line">    UCHAR CoresPerPhysicalProcessor;                                        <span class="comment">//0x3bc</span></span><br><span class="line">    UCHAR LogicalProcessorsPerCore;                                         <span class="comment">//0x3bd</span></span><br><span class="line">    UCHAR PrcbPad0[<span class="number">2</span>];                                                      <span class="comment">//0x3be</span></span><br><span class="line">    ULONG MHz;                                                              <span class="comment">//0x3c0</span></span><br><span class="line">    UCHAR CpuVendor;                                                        <span class="comment">//0x3c4</span></span><br><span class="line">    UCHAR GroupIndex;                                                       <span class="comment">//0x3c5</span></span><br><span class="line">    USHORT Group;                                                           <span class="comment">//0x3c6</span></span><br><span class="line">    ULONG GroupSetMember;                                                   <span class="comment">//0x3c8</span></span><br><span class="line">    ULONG Number;                                                           <span class="comment">//0x3cc</span></span><br><span class="line">    UCHAR PrcbPad1[<span class="number">72</span>];                                                     <span class="comment">//0x3d0</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KSPIN_LOCK_QUEUE</span> <span class="title">LockQueue</span>[17];</span>                                 <span class="comment">//0x418</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KTHREAD</span>* <span class="title">NpxThread</span>;</span>                                             <span class="comment">//0x4a0</span></span><br><span class="line">    ULONG InterruptCount;                                                   <span class="comment">//0x4a4</span></span><br><span class="line">    ULONG KernelTime;                                                       <span class="comment">//0x4a8</span></span><br><span class="line">    ULONG UserTime;                                                         <span class="comment">//0x4ac</span></span><br><span class="line">    ULONG DpcTime;                                                          <span class="comment">//0x4b0</span></span><br><span class="line">    ULONG DpcTimeCount;                                                     <span class="comment">//0x4b4</span></span><br><span class="line">    ULONG InterruptTime;                                                    <span class="comment">//0x4b8</span></span><br><span class="line">    ULONG AdjustDpcThreshold;                                               <span class="comment">//0x4bc</span></span><br><span class="line">    ULONG PageColor;                                                        <span class="comment">//0x4c0</span></span><br><span class="line">    UCHAR DebuggerSavedIRQL;                                                <span class="comment">//0x4c4</span></span><br><span class="line">    UCHAR NodeColor;                                                        <span class="comment">//0x4c5</span></span><br><span class="line">    UCHAR PrcbPad20[<span class="number">2</span>];                                                     <span class="comment">//0x4c6</span></span><br><span class="line">    ULONG NodeShiftedColor;                                                 <span class="comment">//0x4c8</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KNODE</span>* <span class="title">ParentNode</span>;</span>                                              <span class="comment">//0x4cc</span></span><br><span class="line">    ULONG SecondaryColorMask;                                               <span class="comment">//0x4d0</span></span><br><span class="line">    ULONG DpcTimeLimit;                                                     <span class="comment">//0x4d4</span></span><br><span class="line">    ULONG PrcbPad21[<span class="number">2</span>];                                                     <span class="comment">//0x4d8</span></span><br><span class="line">    ULONG CcFastReadNoWait;                                                 <span class="comment">//0x4e0</span></span><br><span class="line">    ULONG CcFastReadWait;                                                   <span class="comment">//0x4e4</span></span><br><span class="line">    ULONG CcFastReadNotPossible;                                            <span class="comment">//0x4e8</span></span><br><span class="line">    ULONG CcCopyReadNoWait;                                                 <span class="comment">//0x4ec</span></span><br><span class="line">    ULONG CcCopyReadWait;                                                   <span class="comment">//0x4f0</span></span><br><span class="line">    ULONG CcCopyReadNoWaitMiss;                                             <span class="comment">//0x4f4</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG MmSpinLockOrdering;                                       <span class="comment">//0x4f8</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG IoReadOperationCount;                                     <span class="comment">//0x4fc</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG IoWriteOperationCount;                                    <span class="comment">//0x500</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG IoOtherOperationCount;                                    <span class="comment">//0x504</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">LARGE_INTEGER</span> <span class="title">IoReadTransferCount</span>;</span>                               <span class="comment">//0x508</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">LARGE_INTEGER</span> <span class="title">IoWriteTransferCount</span>;</span>                              <span class="comment">//0x510</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">LARGE_INTEGER</span> <span class="title">IoOtherTransferCount</span>;</span>                              <span class="comment">//0x518</span></span><br><span class="line">    ULONG CcFastMdlReadNoWait;                                              <span class="comment">//0x520</span></span><br><span class="line">    ULONG CcFastMdlReadWait;                                                <span class="comment">//0x524</span></span><br><span class="line">    ULONG CcFastMdlReadNotPossible;                                         <span class="comment">//0x528</span></span><br><span class="line">    ULONG CcMapDataNoWait;                                                  <span class="comment">//0x52c</span></span><br><span class="line">    ULONG CcMapDataWait;                                                    <span class="comment">//0x530</span></span><br><span class="line">    ULONG CcPinMappedDataCount;                                             <span class="comment">//0x534</span></span><br><span class="line">    ULONG CcPinReadNoWait;                                                  <span class="comment">//0x538</span></span><br><span class="line">    ULONG CcPinReadWait;                                                    <span class="comment">//0x53c</span></span><br><span class="line">    ULONG CcMdlReadNoWait;                                                  <span class="comment">//0x540</span></span><br><span class="line">    ULONG CcMdlReadWait;                                                    <span class="comment">//0x544</span></span><br><span class="line">    ULONG CcLazyWriteHotSpots;                                              <span class="comment">//0x548</span></span><br><span class="line">    ULONG CcLazyWriteIos;                                                   <span class="comment">//0x54c</span></span><br><span class="line">    ULONG CcLazyWritePages;                                                 <span class="comment">//0x550</span></span><br><span class="line">    ULONG CcDataFlushes;                                                    <span class="comment">//0x554</span></span><br><span class="line">    ULONG CcDataPages;                                                      <span class="comment">//0x558</span></span><br><span class="line">    ULONG CcLostDelayedWrites;                                              <span class="comment">//0x55c</span></span><br><span class="line">    ULONG CcFastReadResourceMiss;                                           <span class="comment">//0x560</span></span><br><span class="line">    ULONG CcCopyReadWaitMiss;                                               <span class="comment">//0x564</span></span><br><span class="line">    ULONG CcFastMdlReadResourceMiss;                                        <span class="comment">//0x568</span></span><br><span class="line">    ULONG CcMapDataNoWaitMiss;                                              <span class="comment">//0x56c</span></span><br><span class="line">    ULONG CcMapDataWaitMiss;                                                <span class="comment">//0x570</span></span><br><span class="line">    ULONG CcPinReadNoWaitMiss;                                              <span class="comment">//0x574</span></span><br><span class="line">    ULONG CcPinReadWaitMiss;                                                <span class="comment">//0x578</span></span><br><span class="line">    ULONG CcMdlReadNoWaitMiss;                                              <span class="comment">//0x57c</span></span><br><span class="line">    ULONG CcMdlReadWaitMiss;                                                <span class="comment">//0x580</span></span><br><span class="line">    ULONG CcReadAheadIos;                                                   <span class="comment">//0x584</span></span><br><span class="line">    ULONG KeAlignmentFixupCount;                                            <span class="comment">//0x588</span></span><br><span class="line">    ULONG KeExceptionDispatchCount;                                         <span class="comment">//0x58c</span></span><br><span class="line">    ULONG KeSystemCalls;                                                    <span class="comment">//0x590</span></span><br><span class="line">    ULONG AvailableTime;                                                    <span class="comment">//0x594</span></span><br><span class="line">    ULONG PrcbPad22[<span class="number">2</span>];                                                     <span class="comment">//0x598</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">PP_LOOKASIDE_LIST</span> <span class="title">PPLookasideList</span>[16];</span>                          <span class="comment">//0x5a0</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">GENERAL_LOOKASIDE_POOL</span> <span class="title">PPNPagedLookasideList</span>[32];</span>               <span class="comment">//0x620</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">GENERAL_LOOKASIDE_POOL</span> <span class="title">PPPagedLookasideList</span>[32];</span>                <span class="comment">//0xf20</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONG PacketBarrier;                                           <span class="comment">//0x1820</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG ReverseStall;                                             <span class="comment">//0x1824</span></span><br><span class="line">    VOID* IpiFrame;                                                         <span class="comment">//0x1828</span></span><br><span class="line">    UCHAR PrcbPad3[<span class="number">52</span>];                                                     <span class="comment">//0x182c</span></span><br><span class="line">    VOID* <span class="keyword">volatile</span> CurrentPacket[<span class="number">3</span>];                                        <span class="comment">//0x1860</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONG TargetSet;                                               <span class="comment">//0x186c</span></span><br><span class="line">    VOID (* volatileWorkerRoutine)(VOID* arg1, VOID* arg2, VOID* arg3, VOID* arg4); <span class="comment">//0x1870</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONG IpiFrozen;                                               <span class="comment">//0x1874</span></span><br><span class="line">    UCHAR PrcbPad4[<span class="number">40</span>];                                                     <span class="comment">//0x1878</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONG RequestSummary;                                          <span class="comment">//0x18a0</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KPRCB</span>* <span class="title">volatile</span> <span class="title">SignalDone</span>;</span>                                     <span class="comment">//0x18a4</span></span><br><span class="line">    UCHAR PrcbPad50[<span class="number">56</span>];                                                    <span class="comment">//0x18a8</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KDPC_DATA</span> <span class="title">DpcData</span>[2];</span>                                           <span class="comment">//0x18e0</span></span><br><span class="line">    VOID* DpcStack;                                                         <span class="comment">//0x1908</span></span><br><span class="line">    LONG MaximumDpcQueueDepth;                                              <span class="comment">//0x190c</span></span><br><span class="line">    ULONG DpcRequestRate;                                                   <span class="comment">//0x1910</span></span><br><span class="line">    ULONG MinimumDpcRate;                                                   <span class="comment">//0x1914</span></span><br><span class="line">    ULONG DpcLastCount;                                                     <span class="comment">//0x1918</span></span><br><span class="line">    ULONG PrcbLock;                                                         <span class="comment">//0x191c</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KGATE</span> <span class="title">DpcGate</span>;</span>                                                  <span class="comment">//0x1920</span></span><br><span class="line">    UCHAR ThreadDpcEnable;                                                  <span class="comment">//0x1930</span></span><br><span class="line">    <span class="keyword">volatile</span> UCHAR QuantumEnd;                                              <span class="comment">//0x1931</span></span><br><span class="line">    <span class="keyword">volatile</span> UCHAR DpcRoutineActive;                                        <span class="comment">//0x1932</span></span><br><span class="line">    <span class="keyword">volatile</span> UCHAR IdleSchedule;                                            <span class="comment">//0x1933</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">volatile</span> LONG DpcRequestSummary;                                    <span class="comment">//0x1934</span></span><br><span class="line">        SHORT DpcRequestSlot[<span class="number">2</span>];                                            <span class="comment">//0x1934</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            SHORT NormalDpcState;                                           <span class="comment">//0x1934</span></span><br><span class="line">            <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">            &#123;</span></span><br><span class="line">                <span class="keyword">volatile</span> USHORT DpcThreadActive:<span class="number">1</span>;                          <span class="comment">//0x1936</span></span><br><span class="line">                SHORT ThreadDpcState;                                       <span class="comment">//0x1936</span></span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">volatile</span> ULONG TimerHand;                                               <span class="comment">//0x1938</span></span><br><span class="line">    ULONG LastTick;                                                         <span class="comment">//0x193c</span></span><br><span class="line">    LONG MasterOffset;                                                      <span class="comment">//0x1940</span></span><br><span class="line">    ULONG PrcbPad41[<span class="number">2</span>];                                                     <span class="comment">//0x1944</span></span><br><span class="line">    ULONG PeriodicCount;                                                    <span class="comment">//0x194c</span></span><br><span class="line">    ULONG PeriodicBias;                                                     <span class="comment">//0x1950</span></span><br><span class="line">    ULONGLONG TickOffset;                                                   <span class="comment">//0x1958</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KTIMER_TABLE</span> <span class="title">TimerTable</span>;</span>                                        <span class="comment">//0x1960</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KDPC</span> <span class="title">CallDpc</span>;</span>                                                   <span class="comment">//0x31a0</span></span><br><span class="line">    LONG ClockKeepAlive;                                                    <span class="comment">//0x31c0</span></span><br><span class="line">    UCHAR ClockCheckSlot;                                                   <span class="comment">//0x31c4</span></span><br><span class="line">    UCHAR ClockPollCycle;                                                   <span class="comment">//0x31c5</span></span><br><span class="line">    UCHAR PrcbPad6[<span class="number">2</span>];                                                      <span class="comment">//0x31c6</span></span><br><span class="line">    LONG DpcWatchdogPeriod;                                                 <span class="comment">//0x31c8</span></span><br><span class="line">    LONG DpcWatchdogCount;                                                  <span class="comment">//0x31cc</span></span><br><span class="line">    LONG ThreadWatchdogPeriod;                                              <span class="comment">//0x31d0</span></span><br><span class="line">    LONG ThreadWatchdogCount;                                               <span class="comment">//0x31d4</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG KeSpinLockOrdering;                                       <span class="comment">//0x31d8</span></span><br><span class="line">    ULONG PrcbPad70[<span class="number">1</span>];                                                     <span class="comment">//0x31dc</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">WaitListHead</span>;</span>                                        <span class="comment">//0x31e0</span></span><br><span class="line">    ULONG WaitLock;                                                         <span class="comment">//0x31e8</span></span><br><span class="line">    ULONG ReadySummary;                                                     <span class="comment">//0x31ec</span></span><br><span class="line">    ULONG QueueIndex;                                                       <span class="comment">//0x31f0</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">SINGLE_LIST_ENTRY</span> <span class="title">DeferredReadyListHead</span>;</span>                        <span class="comment">//0x31f4</span></span><br><span class="line">    ULONGLONG StartCycles;                                                  <span class="comment">//0x31f8</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONGLONG CycleTime;                                           <span class="comment">//0x3200</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONG HighCycleTime;                                           <span class="comment">//0x3208</span></span><br><span class="line">    ULONG PrcbPad71;                                                        <span class="comment">//0x320c</span></span><br><span class="line">    ULONGLONG PrcbPad72[<span class="number">2</span>];                                                 <span class="comment">//0x3210</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">DispatcherReadyListHead</span>[32];</span>                         <span class="comment">//0x3220</span></span><br><span class="line">    VOID* ChainedInterruptList;                                             <span class="comment">//0x3320</span></span><br><span class="line">    LONG LookasideIrpFloat;                                                 <span class="comment">//0x3324</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG MmPageFaultCount;                                         <span class="comment">//0x3328</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG MmCopyOnWriteCount;                                       <span class="comment">//0x332c</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG MmTransitionCount;                                        <span class="comment">//0x3330</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG MmCacheTransitionCount;                                   <span class="comment">//0x3334</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG MmDemandZeroCount;                                        <span class="comment">//0x3338</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG MmPageReadCount;                                          <span class="comment">//0x333c</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG MmPageReadIoCount;                                        <span class="comment">//0x3340</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG MmCacheReadCount;                                         <span class="comment">//0x3344</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG MmCacheIoCount;                                           <span class="comment">//0x3348</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG MmDirtyPagesWriteCount;                                   <span class="comment">//0x334c</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG MmDirtyWriteIoCount;                                      <span class="comment">//0x3350</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG MmMappedPagesWriteCount;                                  <span class="comment">//0x3354</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG MmMappedWriteIoCount;                                     <span class="comment">//0x3358</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONG CachedCommit;                                            <span class="comment">//0x335c</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONG CachedResidentAvailable;                                 <span class="comment">//0x3360</span></span><br><span class="line">    VOID* HyperPte;                                                         <span class="comment">//0x3364</span></span><br><span class="line">    UCHAR PrcbPad8[<span class="number">4</span>];                                                      <span class="comment">//0x3368</span></span><br><span class="line">    UCHAR VendorString[<span class="number">13</span>];                                                 <span class="comment">//0x336c</span></span><br><span class="line">    UCHAR InitialApicId;                                                    <span class="comment">//0x3379</span></span><br><span class="line">    UCHAR LogicalProcessorsPerPhysicalProcessor;                            <span class="comment">//0x337a</span></span><br><span class="line">    UCHAR PrcbPad9[<span class="number">5</span>];                                                      <span class="comment">//0x337b</span></span><br><span class="line">    ULONG FeatureBits;                                                      <span class="comment">//0x3380</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">LARGE_INTEGER</span> <span class="title">UpdateSignature</span>;</span>                                   <span class="comment">//0x3388</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONGLONG IsrTime;                                             <span class="comment">//0x3390</span></span><br><span class="line">    ULONGLONG RuntimeAccumulation;                                          <span class="comment">//0x3398</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">PROCESSOR_POWER_STATE</span> <span class="title">PowerState</span>;</span>                               <span class="comment">//0x33a0</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KDPC</span> <span class="title">DpcWatchdogDpc</span>;</span>                                            <span class="comment">//0x3468</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KTIMER</span> <span class="title">DpcWatchdogTimer</span>;</span>                                        <span class="comment">//0x3488</span></span><br><span class="line">    VOID* WheaInfo;                                                         <span class="comment">//0x34b0</span></span><br><span class="line">    VOID* EtwSupport;                                                       <span class="comment">//0x34b4</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">SLIST_HEADER</span> <span class="title">InterruptObjectPool</span>;</span>                                <span class="comment">//0x34b8</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">SLIST_HEADER</span> <span class="title">HypercallPageList</span>;</span>                                  <span class="comment">//0x34c0</span></span><br><span class="line">    VOID* HypercallPageVirtual;                                             <span class="comment">//0x34c8</span></span><br><span class="line">    VOID* VirtualApicAssist;                                                <span class="comment">//0x34cc</span></span><br><span class="line">    ULONGLONG* StatisticsPage;                                              <span class="comment">//0x34d0</span></span><br><span class="line">    VOID* RateControl;                                                      <span class="comment">//0x34d4</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">CACHE_DESCRIPTOR</span> <span class="title">Cache</span>[5];</span>                                      <span class="comment">//0x34d8</span></span><br><span class="line">    ULONG CacheCount;                                                       <span class="comment">//0x3514</span></span><br><span class="line">    ULONG CacheProcessorMask[<span class="number">5</span>];                                            <span class="comment">//0x3518</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KAFFINITY_EX</span> <span class="title">PackageProcessorSet</span>;</span>                               <span class="comment">//0x352c</span></span><br><span class="line">    ULONG PrcbPad91[<span class="number">1</span>];                                                     <span class="comment">//0x3538</span></span><br><span class="line">    ULONG CoreProcessorSet;                                                 <span class="comment">//0x353c</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KDPC</span> <span class="title">TimerExpirationDpc</span>;</span>                                        <span class="comment">//0x3540</span></span><br><span class="line">    ULONG SpinLockAcquireCount;                                             <span class="comment">//0x3560</span></span><br><span class="line">    ULONG SpinLockContentionCount;                                          <span class="comment">//0x3564</span></span><br><span class="line">    ULONG SpinLockSpinCount;                                                <span class="comment">//0x3568</span></span><br><span class="line">    ULONG IpiSendRequestBroadcastCount;                                     <span class="comment">//0x356c</span></span><br><span class="line">    ULONG IpiSendRequestRoutineCount;                                       <span class="comment">//0x3570</span></span><br><span class="line">    ULONG IpiSendSoftwareInterruptCount;                                    <span class="comment">//0x3574</span></span><br><span class="line">    ULONG ExInitializeResourceCount;                                        <span class="comment">//0x3578</span></span><br><span class="line">    ULONG ExReInitializeResourceCount;                                      <span class="comment">//0x357c</span></span><br><span class="line">    ULONG ExDeleteResourceCount;                                            <span class="comment">//0x3580</span></span><br><span class="line">    ULONG ExecutiveResourceAcquiresCount;                                   <span class="comment">//0x3584</span></span><br><span class="line">    ULONG ExecutiveResourceContentionsCount;                                <span class="comment">//0x3588</span></span><br><span class="line">    ULONG ExecutiveResourceReleaseExclusiveCount;                           <span class="comment">//0x358c</span></span><br><span class="line">    ULONG ExecutiveResourceReleaseSharedCount;                              <span class="comment">//0x3590</span></span><br><span class="line">    ULONG ExecutiveResourceConvertsCount;                                   <span class="comment">//0x3594</span></span><br><span class="line">    ULONG ExAcqResExclusiveAttempts;                                        <span class="comment">//0x3598</span></span><br><span class="line">    ULONG ExAcqResExclusiveAcquiresExclusive;                               <span class="comment">//0x359c</span></span><br><span class="line">    ULONG ExAcqResExclusiveAcquiresExclusiveRecursive;                      <span class="comment">//0x35a0</span></span><br><span class="line">    ULONG ExAcqResExclusiveWaits;                                           <span class="comment">//0x35a4</span></span><br><span class="line">    ULONG ExAcqResExclusiveNotAcquires;                                     <span class="comment">//0x35a8</span></span><br><span class="line">    ULONG ExAcqResSharedAttempts;                                           <span class="comment">//0x35ac</span></span><br><span class="line">    ULONG ExAcqResSharedAcquiresExclusive;                                  <span class="comment">//0x35b0</span></span><br><span class="line">    ULONG ExAcqResSharedAcquiresShared;                                     <span class="comment">//0x35b4</span></span><br><span class="line">    ULONG ExAcqResSharedAcquiresSharedRecursive;                            <span class="comment">//0x35b8</span></span><br><span class="line">    ULONG ExAcqResSharedWaits;                                              <span class="comment">//0x35bc</span></span><br><span class="line">    ULONG ExAcqResSharedNotAcquires;                                        <span class="comment">//0x35c0</span></span><br><span class="line">    ULONG ExAcqResSharedStarveExclusiveAttempts;                            <span class="comment">//0x35c4</span></span><br><span class="line">    ULONG ExAcqResSharedStarveExclusiveAcquiresExclusive;                   <span class="comment">//0x35c8</span></span><br><span class="line">    ULONG ExAcqResSharedStarveExclusiveAcquiresShared;                      <span class="comment">//0x35cc</span></span><br><span class="line">    ULONG ExAcqResSharedStarveExclusiveAcquiresSharedRecursive;             <span class="comment">//0x35d0</span></span><br><span class="line">    ULONG ExAcqResSharedStarveExclusiveWaits;                               <span class="comment">//0x35d4</span></span><br><span class="line">    ULONG ExAcqResSharedStarveExclusiveNotAcquires;                         <span class="comment">//0x35d8</span></span><br><span class="line">    ULONG ExAcqResSharedWaitForExclusiveAttempts;                           <span class="comment">//0x35dc</span></span><br><span class="line">    ULONG ExAcqResSharedWaitForExclusiveAcquiresExclusive;                  <span class="comment">//0x35e0</span></span><br><span class="line">    ULONG ExAcqResSharedWaitForExclusiveAcquiresShared;                     <span class="comment">//0x35e4</span></span><br><span class="line">    ULONG ExAcqResSharedWaitForExclusiveAcquiresSharedRecursive;            <span class="comment">//0x35e8</span></span><br><span class="line">    ULONG ExAcqResSharedWaitForExclusiveWaits;                              <span class="comment">//0x35ec</span></span><br><span class="line">    ULONG ExAcqResSharedWaitForExclusiveNotAcquires;                        <span class="comment">//0x35f0</span></span><br><span class="line">    ULONG ExSetResOwnerPointerExclusive;                                    <span class="comment">//0x35f4</span></span><br><span class="line">    ULONG ExSetResOwnerPointerSharedNew;                                    <span class="comment">//0x35f8</span></span><br><span class="line">    ULONG ExSetResOwnerPointerSharedOld;                                    <span class="comment">//0x35fc</span></span><br><span class="line">    ULONG ExTryToAcqExclusiveAttempts;                                      <span class="comment">//0x3600</span></span><br><span class="line">    ULONG ExTryToAcqExclusiveAcquires;                                      <span class="comment">//0x3604</span></span><br><span class="line">    ULONG ExBoostExclusiveOwner;                                            <span class="comment">//0x3608</span></span><br><span class="line">    ULONG ExBoostSharedOwners;                                              <span class="comment">//0x360c</span></span><br><span class="line">    ULONG ExEtwSynchTrackingNotificationsCount;                             <span class="comment">//0x3610</span></span><br><span class="line">    ULONG ExEtwSynchTrackingNotificationsAccountedCount;                    <span class="comment">//0x3614</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">CONTEXT</span>* <span class="title">Context</span>;</span>                                               <span class="comment">//0x3618</span></span><br><span class="line">    ULONG ContextFlags;                                                     <span class="comment">//0x361c</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">XSAVE_AREA</span>* <span class="title">ExtendedState</span>;</span>                                      <span class="comment">//0x3620</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>+4 CurrentThread：当前CPU正在跑的线程。</li>
<li>+8 NextThread：将要切换的线程。</li>
<li>+C IdleThread：如果没有要切换的线程，CPU将要跑的空闲线程。</li>
</ul>
<p>其余字段在后续分析内核代码时再了解。</p>
<h1 id="2-EPROCESS结构"><a href="#2-EPROCESS结构" class="headerlink" title="2.EPROCESS结构"></a>2.EPROCESS结构</h1><p>在3环下，每个进程都有一个PEB结构用来描述这个进程的一些信息。这些信息仅是为了3环更好的操作进程。而在0环，每个进程又有一个结构体用于描述该进程的所有信息：EPROCESS。</p>
<p>结构体成员列表：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//0x2c0 bytes (sizeof)</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">EPROCESS</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KPROCESS</span> <span class="title">Pcb</span>;</span>                                                   <span class="comment">//0x0</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">EX_PUSH_LOCK</span> <span class="title">ProcessLock</span>;</span>                                       <span class="comment">//0x98</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">LARGE_INTEGER</span> <span class="title">CreateTime</span>;</span>                                        <span class="comment">//0xa0</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">LARGE_INTEGER</span> <span class="title">ExitTime</span>;</span>                                          <span class="comment">//0xa8</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">EX_RUNDOWN_REF</span> <span class="title">RundownProtect</span>;</span>                                  <span class="comment">//0xb0</span></span><br><span class="line">    VOID* UniqueProcessId;                                                  <span class="comment">//0xb4</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">ActiveProcessLinks</span>;</span>                                  <span class="comment">//0xb8</span></span><br><span class="line">    ULONG ProcessQuotaUsage[<span class="number">2</span>];                                             <span class="comment">//0xc0</span></span><br><span class="line">    ULONG ProcessQuotaPeak[<span class="number">2</span>];                                              <span class="comment">//0xc8</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONG CommitCharge;                                            <span class="comment">//0xd0</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">EPROCESS_QUOTA_BLOCK</span>* <span class="title">QuotaBlock</span>;</span>                               <span class="comment">//0xd4</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">PS_CPU_QUOTA_BLOCK</span>* <span class="title">CpuQuotaBlock</span>;</span>                              <span class="comment">//0xd8</span></span><br><span class="line">    ULONG PeakVirtualSize;                                                  <span class="comment">//0xdc</span></span><br><span class="line">    ULONG VirtualSize;                                                      <span class="comment">//0xe0</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">SessionProcessLinks</span>;</span>                                 <span class="comment">//0xe4</span></span><br><span class="line">    VOID* DebugPort;                                                        <span class="comment">//0xec</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        VOID* ExceptionPortData;                                            <span class="comment">//0xf0</span></span><br><span class="line">        ULONG ExceptionPortValue;                                           <span class="comment">//0xf0</span></span><br><span class="line">        ULONG ExceptionPortState:<span class="number">3</span>;                                         <span class="comment">//0xf0</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">HANDLE_TABLE</span>* <span class="title">ObjectTable</span>;</span>                                      <span class="comment">//0xf4</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">EX_FAST_REF</span> <span class="title">Token</span>;</span>                                              <span class="comment">//0xf8</span></span><br><span class="line">    ULONG WorkingSetPage;                                                   <span class="comment">//0xfc</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">EX_PUSH_LOCK</span> <span class="title">AddressCreationLock</span>;</span>                               <span class="comment">//0x100</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">ETHREAD</span>* <span class="title">RotateInProgress</span>;</span>                                      <span class="comment">//0x104</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">ETHREAD</span>* <span class="title">ForkInProgress</span>;</span>                                        <span class="comment">//0x108</span></span><br><span class="line">    ULONG HardwareTrigger;                                                  <span class="comment">//0x10c</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">MM_AVL_TABLE</span>* <span class="title">PhysicalVadRoot</span>;</span>                                  <span class="comment">//0x110</span></span><br><span class="line">    VOID* CloneRoot;                                                        <span class="comment">//0x114</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONG NumberOfPrivatePages;                                    <span class="comment">//0x118</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONG NumberOfLockedPages;                                     <span class="comment">//0x11c</span></span><br><span class="line">    VOID* Win32Process;                                                     <span class="comment">//0x120</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">EJOB</span>* <span class="title">volatile</span> <span class="title">Job</span>;</span>                                             <span class="comment">//0x124</span></span><br><span class="line">    VOID* SectionObject;                                                    <span class="comment">//0x128</span></span><br><span class="line">    VOID* SectionBaseAddress;                                               <span class="comment">//0x12c</span></span><br><span class="line">    ULONG Cookie;                                                           <span class="comment">//0x130</span></span><br><span class="line">    ULONG Spare8;                                                           <span class="comment">//0x134</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">PAGEFAULT_HISTORY</span>* <span class="title">WorkingSetWatch</span>;</span>                             <span class="comment">//0x138</span></span><br><span class="line">    VOID* Win32WindowStation;                                               <span class="comment">//0x13c</span></span><br><span class="line">    VOID* InheritedFromUniqueProcessId;                                     <span class="comment">//0x140</span></span><br><span class="line">    VOID* LdtInformation;                                                   <span class="comment">//0x144</span></span><br><span class="line">    VOID* VdmObjects;                                                       <span class="comment">//0x148</span></span><br><span class="line">    ULONG ConsoleHostProcess;                                               <span class="comment">//0x14c</span></span><br><span class="line">    VOID* DeviceMap;                                                        <span class="comment">//0x150</span></span><br><span class="line">    VOID* EtwDataSource;                                                    <span class="comment">//0x154</span></span><br><span class="line">    VOID* FreeTebHint;                                                      <span class="comment">//0x158</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> _<span class="title">HARDWARE_PTE</span> <span class="title">PageDirectoryPte</span>;</span>                              <span class="comment">//0x160</span></span><br><span class="line">        ULONGLONG Filler;                                                   <span class="comment">//0x160</span></span><br><span class="line">    &#125;;</span><br><span class="line">    VOID* Session;                                                          <span class="comment">//0x168</span></span><br><span class="line">    UCHAR ImageFileName[<span class="number">15</span>];                                                <span class="comment">//0x16c</span></span><br><span class="line">    UCHAR PriorityClass;                                                    <span class="comment">//0x17b</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">JobLinks</span>;</span>                                            <span class="comment">//0x17c</span></span><br><span class="line">    VOID* LockedPagesList;                                                  <span class="comment">//0x184</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">ThreadListHead</span>;</span>                                      <span class="comment">//0x188</span></span><br><span class="line">    VOID* SecurityPort;                                                     <span class="comment">//0x190</span></span><br><span class="line">    VOID* PaeTop;                                                           <span class="comment">//0x194</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONG ActiveThreads;                                           <span class="comment">//0x198</span></span><br><span class="line">    ULONG ImagePathHash;                                                    <span class="comment">//0x19c</span></span><br><span class="line">    ULONG DefaultHardErrorProcessing;                                       <span class="comment">//0x1a0</span></span><br><span class="line">    LONG LastThreadExitStatus;                                              <span class="comment">//0x1a4</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">PEB</span>* <span class="title">Peb</span>;</span>                                                       <span class="comment">//0x1a8</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">EX_FAST_REF</span> <span class="title">PrefetchTrace</span>;</span>                                      <span class="comment">//0x1ac</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">LARGE_INTEGER</span> <span class="title">ReadOperationCount</span>;</span>                                <span class="comment">//0x1b0</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">LARGE_INTEGER</span> <span class="title">WriteOperationCount</span>;</span>                               <span class="comment">//0x1b8</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">LARGE_INTEGER</span> <span class="title">OtherOperationCount</span>;</span>                               <span class="comment">//0x1c0</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">LARGE_INTEGER</span> <span class="title">ReadTransferCount</span>;</span>                                 <span class="comment">//0x1c8</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">LARGE_INTEGER</span> <span class="title">WriteTransferCount</span>;</span>                                <span class="comment">//0x1d0</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">LARGE_INTEGER</span> <span class="title">OtherTransferCount</span>;</span>                                <span class="comment">//0x1d8</span></span><br><span class="line">    ULONG CommitChargeLimit;                                                <span class="comment">//0x1e0</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONG CommitChargePeak;                                        <span class="comment">//0x1e4</span></span><br><span class="line">    VOID* AweInfo;                                                          <span class="comment">//0x1e8</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">SE_AUDIT_PROCESS_CREATION_INFO</span> <span class="title">SeAuditProcessCreationInfo</span>;</span>      <span class="comment">//0x1ec</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">MMSUPPORT</span> <span class="title">Vm</span>;</span>                                                   <span class="comment">//0x1f0</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">MmProcessLinks</span>;</span>                                      <span class="comment">//0x25c</span></span><br><span class="line">    VOID* HighestUserAddress;                                               <span class="comment">//0x264</span></span><br><span class="line">    ULONG ModifiedPageCount;                                                <span class="comment">//0x268</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        ULONG Flags2;                                                       <span class="comment">//0x26c</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            ULONG JobNotReallyActive:<span class="number">1</span>;                                     <span class="comment">//0x26c</span></span><br><span class="line">            ULONG AccountingFolded:<span class="number">1</span>;                                       <span class="comment">//0x26c</span></span><br><span class="line">            ULONG NewProcessReported:<span class="number">1</span>;                                     <span class="comment">//0x26c</span></span><br><span class="line">            ULONG ExitProcessReported:<span class="number">1</span>;                                    <span class="comment">//0x26c</span></span><br><span class="line">            ULONG ReportCommitChanges:<span class="number">1</span>;                                    <span class="comment">//0x26c</span></span><br><span class="line">            ULONG LastReportMemory:<span class="number">1</span>;                                       <span class="comment">//0x26c</span></span><br><span class="line">            ULONG ReportPhysicalPageChanges:<span class="number">1</span>;                              <span class="comment">//0x26c</span></span><br><span class="line">            ULONG HandleTableRundown:<span class="number">1</span>;                                     <span class="comment">//0x26c</span></span><br><span class="line">            ULONG NeedsHandleRundown:<span class="number">1</span>;                                     <span class="comment">//0x26c</span></span><br><span class="line">            ULONG RefTraceEnabled:<span class="number">1</span>;                                        <span class="comment">//0x26c</span></span><br><span class="line">            ULONG NumaAware:<span class="number">1</span>;                                              <span class="comment">//0x26c</span></span><br><span class="line">            ULONG ProtectedProcess:<span class="number">1</span>;                                       <span class="comment">//0x26c</span></span><br><span class="line">            ULONG DefaultPagePriority:<span class="number">3</span>;                                    <span class="comment">//0x26c</span></span><br><span class="line">            ULONG PrimaryTokenFrozen:<span class="number">1</span>;                                     <span class="comment">//0x26c</span></span><br><span class="line">            ULONG ProcessVerifierTarget:<span class="number">1</span>;                                  <span class="comment">//0x26c</span></span><br><span class="line">            ULONG StackRandomizationDisabled:<span class="number">1</span>;                             <span class="comment">//0x26c</span></span><br><span class="line">            ULONG AffinityPermanent:<span class="number">1</span>;                                      <span class="comment">//0x26c</span></span><br><span class="line">            ULONG AffinityUpdateEnable:<span class="number">1</span>;                                   <span class="comment">//0x26c</span></span><br><span class="line">            ULONG PropagateNode:<span class="number">1</span>;                                          <span class="comment">//0x26c</span></span><br><span class="line">            ULONG ExplicitAffinity:<span class="number">1</span>;                                       <span class="comment">//0x26c</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        ULONG Flags;                                                        <span class="comment">//0x270</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            ULONG CreateReported:<span class="number">1</span>;                                         <span class="comment">//0x270</span></span><br><span class="line">            ULONG NoDebugInherit:<span class="number">1</span>;                                         <span class="comment">//0x270</span></span><br><span class="line">            ULONG ProcessExiting:<span class="number">1</span>;                                         <span class="comment">//0x270</span></span><br><span class="line">            ULONG ProcessDelete:<span class="number">1</span>;                                          <span class="comment">//0x270</span></span><br><span class="line">            ULONG Wow64SplitPages:<span class="number">1</span>;                                        <span class="comment">//0x270</span></span><br><span class="line">            ULONG VmDeleted:<span class="number">1</span>;                                              <span class="comment">//0x270</span></span><br><span class="line">            ULONG OutswapEnabled:<span class="number">1</span>;                                         <span class="comment">//0x270</span></span><br><span class="line">            ULONG Outswapped:<span class="number">1</span>;                                             <span class="comment">//0x270</span></span><br><span class="line">            ULONG ForkFailed:<span class="number">1</span>;                                             <span class="comment">//0x270</span></span><br><span class="line">            ULONG Wow64VaSpace4Gb:<span class="number">1</span>;                                        <span class="comment">//0x270</span></span><br><span class="line">            ULONG AddressSpaceInitialized:<span class="number">2</span>;                                <span class="comment">//0x270</span></span><br><span class="line">            ULONG SetTimerResolution:<span class="number">1</span>;                                     <span class="comment">//0x270</span></span><br><span class="line">            ULONG BreakOnTermination:<span class="number">1</span>;                                     <span class="comment">//0x270</span></span><br><span class="line">            ULONG DeprioritizeViews:<span class="number">1</span>;                                      <span class="comment">//0x270</span></span><br><span class="line">            ULONG WriteWatch:<span class="number">1</span>;                                             <span class="comment">//0x270</span></span><br><span class="line">            ULONG ProcessInSession:<span class="number">1</span>;                                       <span class="comment">//0x270</span></span><br><span class="line">            ULONG OverrideAddressSpace:<span class="number">1</span>;                                   <span class="comment">//0x270</span></span><br><span class="line">            ULONG HasAddressSpace:<span class="number">1</span>;                                        <span class="comment">//0x270</span></span><br><span class="line">            ULONG LaunchPrefetched:<span class="number">1</span>;                                       <span class="comment">//0x270</span></span><br><span class="line">            ULONG InjectInpageErrors:<span class="number">1</span>;                                     <span class="comment">//0x270</span></span><br><span class="line">            ULONG VmTopDown:<span class="number">1</span>;                                              <span class="comment">//0x270</span></span><br><span class="line">            ULONG ImageNotifyDone:<span class="number">1</span>;                                        <span class="comment">//0x270</span></span><br><span class="line">            ULONG PdeUpdateNeeded:<span class="number">1</span>;                                        <span class="comment">//0x270</span></span><br><span class="line">            ULONG VdmAllowed:<span class="number">1</span>;                                             <span class="comment">//0x270</span></span><br><span class="line">            ULONG CrossSessionCreate:<span class="number">1</span>;                                     <span class="comment">//0x270</span></span><br><span class="line">            ULONG ProcessInserted:<span class="number">1</span>;                                        <span class="comment">//0x270</span></span><br><span class="line">            ULONG DefaultIoPriority:<span class="number">3</span>;                                      <span class="comment">//0x270</span></span><br><span class="line">            ULONG ProcessSelfDelete:<span class="number">1</span>;                                      <span class="comment">//0x270</span></span><br><span class="line">            ULONG SetTimerResolutionLink:<span class="number">1</span>;                                 <span class="comment">//0x270</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    LONG ExitStatus;                                                        <span class="comment">//0x274</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">MM_AVL_TABLE</span> <span class="title">VadRoot</span>;</span>                                           <span class="comment">//0x278</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">ALPC_PROCESS_CONTEXT</span> <span class="title">AlpcContext</span>;</span>                               <span class="comment">//0x298</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">TimerResolutionLink</span>;</span>                                 <span class="comment">//0x2a8</span></span><br><span class="line">    ULONG RequestedTimerResolution;                                         <span class="comment">//0x2b0</span></span><br><span class="line">    ULONG ActiveThreadsHighWatermark;                                       <span class="comment">//0x2b4</span></span><br><span class="line">    ULONG SmallestTimerResolution;                                          <span class="comment">//0x2b8</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">PO_DIAG_STACK_RECORD</span>* <span class="title">TimerResolutionStackRecord</span>;</span>               <span class="comment">//0x2bc</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>+0 Pcb：Kprocess结构体。参考下文。</li>
<li>+98 ProcessLock：进程锁。修改EPROCESS结构存放锁结构，防止同时修改。改完了置0.</li>
<li>+A0 CreateTime：进程的创建时间。</li>
<li>+A8 ExitTime：进程的退出时间。</li>
<li>+B0 RundownProtect：进程锁。该字段置值后，进程无法被访问、打开、结束，相当于保护。但是会容易卡死。</li>
<li>+B4 UniqueProcessId：进程ID。任务管理器中显示的进程ID就是这个。</li>
<li>+B8 ActiveProcessLinks：双向链表。包括了windows中所有活动的进程。全局变量“PsActiveProcessHead”指向了这个链表的头部。通过该全局变量可以遍历整条链表。</li>
<li>+C0 ProcessQuotaUsage：进程物理页相关统计信息。</li>
<li>+C8 ProcessQuotaPeak：进程物理页相关统计信息。</li>
<li>+D0 CommitCharge：进程虚拟内存相关统计信息。</li>
<li>+D4 QuotaBlock：进程虚拟内存相关统计信息。</li>
<li>+D8 CpuQuotaBlock：进程虚拟内存相关统计信息。</li>
<li>+E4 SessionProcessLinks：会话进程链表。保存了当前登录的用户的所有进程。</li>
<li>+EC DebugPort：调试相关。如果该进程处于调试状态，这里会有值（一个结构体），该结构体用于进程与调试器之间通信。通过循环清0可以达到反调试效果。</li>
<li>+F0 ExceptionPortData：调试相关。</li>
<li>+F4 ObjectTable：进程的句柄表。句柄相关章节再学。</li>
<li>+F8 Token：进程Token。</li>
<li>+FC WorkingSetPage：表明当前进程用了多少个物理页。</li>
<li>+16C ImageFileName：当前进程的进程名。</li>
<li>+188 ThreadListHead：当前进程内所有线程的链表。</li>
<li>+198 ActiveThreads：当前进程内活动的线程数量。</li>
<li>+1A8 Peb。就是3环下该进程的PEB。（PEB结构此处不赘述了，网上有非常多的PEB结构说明。）</li>
<li>+1EC SeAuditProcessCreationInfo：当前进程完整路径。</li>
<li>+26C Flags2：一个联合体，每个位影响该进程的一些属性。</li>
</ul>
<p>ProtectedProcess：进程保护位。该位置1后该进程被保护。CE看不到图片，打不开了进程。OD附加进程列表遍历不到。一个最简单的进程保护。</p>
<p><img src="/.com//1.png"></p>
<p>+270 Flags：一个联合体，每个位影响该进程的一些属性。</p>
<ul>
<li>ProcessExiting：进程退出标志位。置1后表明该进程已退出，但实际还在运行。可以达到反调试的效果。同时进程无法使用任务管理器结束。</li>
<li>ProcessDelete：进程退出标志位。置1后表明该进程已退出，但实际还在运行。可以达到反调试的效果。同时进程无法使用任务管理器结束。</li>
</ul>
<p><img src="/.com//2.png"></p>
<p>BreakOnTermination：该位置1后，任务管理器结束进程时将提示“是否结束系统进程XXX”。结束后windbg将会断下。</p>
<p><img src="/.com//3.png"></p>
<ul>
<li><ul>
<li>VmTopDown：该位置1时，VirtualAlloc一类的申请内存函数将会从大地址开始申请。</li>
<li>ProcessInserted：该位置0后，OD附加进程列表找不到该进程。任务管理器结束不掉该进程。CE打不开该进程，无图标。</li>
</ul>
</li>
<li>+274 ExitStatus：进程退出状态码。进程创建时默认值是250（0x103）。如果不是这个值基本上就是进程退出了。</li>
<li>+278 VadRoot：标识当前进程用户空间（低2G）中哪些地址没被分配。该成员指向了一个二叉树。</li>
</ul>
<h2 id="KPROCESS结构"><a href="#KPROCESS结构" class="headerlink" title="KPROCESS结构"></a>KPROCESS结构</h2><p>Eprocess第一个成员是一个Kprocess结构。</p>
<p>Kprocess结构成员列表：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//0x98 bytes (sizeof)</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">KPROCESS</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">DISPATCHER_HEADER</span> <span class="title">Header</span>;</span>                                       <span class="comment">//0x0</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">ProfileListHead</span>;</span>                                     <span class="comment">//0x10</span></span><br><span class="line">    ULONG DirectoryTableBase;                                               <span class="comment">//0x18</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KGDTENTRY</span> <span class="title">LdtDescriptor</span>;</span>                                        <span class="comment">//0x1c</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KIDTENTRY</span> <span class="title">Int21Descriptor</span>;</span>                                      <span class="comment">//0x24</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">ThreadListHead</span>;</span>                                      <span class="comment">//0x2c</span></span><br><span class="line">    ULONG ProcessLock;                                                      <span class="comment">//0x34</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KAFFINITY_EX</span> <span class="title">Affinity</span>;</span>                                          <span class="comment">//0x38</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">ReadyListHead</span>;</span>                                       <span class="comment">//0x44</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">SINGLE_LIST_ENTRY</span> <span class="title">SwapListEntry</span>;</span>                                <span class="comment">//0x4c</span></span><br><span class="line">    <span class="keyword">volatile</span> <span class="class"><span class="keyword">struct</span> _<span class="title">KAFFINITY_EX</span> <span class="title">ActiveProcessors</span>;</span>                         <span class="comment">//0x50</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            <span class="keyword">volatile</span> LONG AutoAlignment:<span class="number">1</span>;                                  <span class="comment">//0x5c</span></span><br><span class="line">            <span class="keyword">volatile</span> LONG DisableBoost:<span class="number">1</span>;                                   <span class="comment">//0x5c</span></span><br><span class="line">            <span class="keyword">volatile</span> LONG DisableQuantum:<span class="number">1</span>;                                 <span class="comment">//0x5c</span></span><br><span class="line">            <span class="keyword">volatile</span> ULONG ActiveGroupsMask:<span class="number">1</span>;                              <span class="comment">//0x5c</span></span><br><span class="line">            <span class="keyword">volatile</span> LONG ReservedFlags:<span class="number">28</span>;                                 <span class="comment">//0x5c</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">volatile</span> LONG ProcessFlags;                                         <span class="comment">//0x5c</span></span><br><span class="line">    &#125;;</span><br><span class="line">    CHAR BasePriority;                                                      <span class="comment">//0x60</span></span><br><span class="line">    CHAR QuantumReset;                                                      <span class="comment">//0x61</span></span><br><span class="line">    UCHAR Visited;                                                          <span class="comment">//0x62</span></span><br><span class="line">    UCHAR Unused3;                                                          <span class="comment">//0x63</span></span><br><span class="line">    ULONG ThreadSeed[<span class="number">1</span>];                                                    <span class="comment">//0x64</span></span><br><span class="line">    USHORT IdealNode[<span class="number">1</span>];                                                    <span class="comment">//0x68</span></span><br><span class="line">    USHORT IdealGlobalNode;                                                 <span class="comment">//0x6a</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">KEXECUTE_OPTIONS</span> <span class="title">Flags</span>;</span>                                          <span class="comment">//0x6c</span></span><br><span class="line">    UCHAR Unused1;                                                          <span class="comment">//0x6d</span></span><br><span class="line">    USHORT IopmOffset;                                                      <span class="comment">//0x6e</span></span><br><span class="line">    ULONG Unused4;                                                          <span class="comment">//0x70</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">KSTACK_COUNT</span> <span class="title">StackCount</span>;</span>                                         <span class="comment">//0x74</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">ProcessListEntry</span>;</span>                                    <span class="comment">//0x78</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONGLONG CycleTime;                                           <span class="comment">//0x80</span></span><br><span class="line">    ULONG KernelTime;                                                       <span class="comment">//0x88</span></span><br><span class="line">    ULONG UserTime;                                                         <span class="comment">//0x8c</span></span><br><span class="line">    VOID* VdmTrapcHandler;                                                  <span class="comment">//0x90</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>+0 Header：可等待对象头部。所有0环结构体只要以_DISPATCHER_HEADER结构开头的，都可以使用WaitForSingleObject等待。如互斥体、事件。</p>
</li>
<li><p>+10 ProfileListHead：性能分析相关，任务管理器，性能栏那些数据。</p>
</li>
<li><p>+18 DirectoryTableBase：页目录表基址。物理地址，指向页目录表，CR3中的值就从这里获取。</p>
</li>
<li><p>+2C ThreadListHead：当前进程的所有线程结构体链表。</p>
</li>
<li><p>+38 Affinity：亲核性。规定了当前进程内的所有线程可以在哪些CPU上跑，4字节，共32位，每一位对应一个CPU核。如000000A1，转换为二进制为1010 0001，则该进程中的线程只能在0、5、7号CPU上运行。因此32位系统最多支持32核CPU，64位系统支持64核CPU。该值仅为线程结构中的亲核性做初始化赋值使用，没有实际的限制功能。</p>
<p>如果只有1个CPU，但此处值为2（0010），则该进程为一个“死”了的进程。</p>
</li>
<li><p>+44 ReadyListHead：当前进程内的就绪线程链表。</p>
</li>
<li><p>+4C SwapListEntry：交换到文件磁盘上时使用该链表。记录了哪些内存被交换到文件里。</p>
</li>
<li><p>+50 ActiveProcessors：当前进程内正在运行的线程运行在哪些CPU上。</p>
</li>
<li><p>+5C AutoAlignment：强制内存对齐。一般为0。</p>
</li>
<li><p>+5C DisableBoost：置1为关闭当前进程内所有线程的时间碎片。（置1后，不会由于时间中断触发线程切换）</p>
</li>
<li><p>+60 BasePriority：基础优先级。该进程内所有线程最初的优先级。</p>
</li>
<li><p>+61 QuantumReset：当前进程内线程的初始时间碎片。每一次时钟中断会将线程中的时间碎片减6，为0时，切换线程。线程从就绪变为运行时，会从这个值中取到初始的时间碎片。改大这个值会让该进程内的线程跑的更久。</p>
</li>
<li><p>+78 ProcessListEntry：系统内所有进程的链表。win7及以上此处为空，已弃用。</p>
</li>
<li><p>+80 CycleTime：当前进程执行了多少个指令周期。当进程结束时才会被赋值，指明了该进程存活了多久。</p>
</li>
<li><p>+88 KernelTime：（统计信息）当前进程在0环的运行时间。当进程结束时才会被赋值，指明了该进程存活了多久。</p>
</li>
<li><p>+8C UserTime：（统计信息）当前进程在3环的运行时间。当进程结束时才会被赋值，指明了该进程存活了多久。</p>
</li>
<li><p>+90 VdmTrapcHandler：虚拟8086模式时使用。</p>
</li>
</ul>
<h1 id="3-ETHREAD结构"><a href="#3-ETHREAD结构" class="headerlink" title="3.ETHREAD结构"></a>3.ETHREAD结构</h1><p>与进程一样， 3环下有TEB描述某个线程。在0环，也有一个ETHREAD描述某个线程的所有信息。</p>
<p>ETHREAD结构成员列表：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//0x2b8 bytes (sizeof)</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">ETHREAD</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KTHREAD</span> <span class="title">Tcb</span>;</span>                                                    <span class="comment">//0x0</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">LARGE_INTEGER</span> <span class="title">CreateTime</span>;</span>                                        <span class="comment">//0x200</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">union</span> _<span class="title">LARGE_INTEGER</span> <span class="title">ExitTime</span>;</span>                                      <span class="comment">//0x208</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">KeyedWaitChain</span>;</span>                                  <span class="comment">//0x208</span></span><br><span class="line">    &#125;;</span><br><span class="line">    LONG ExitStatus;                                                        <span class="comment">//0x210</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">PostBlockList</span>;</span>                                   <span class="comment">//0x214</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            VOID* ForwardLinkShadow;                                        <span class="comment">//0x214</span></span><br><span class="line">            VOID* StartAddress;                                             <span class="comment">//0x218</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> _<span class="title">TERMINATION_PORT</span>* <span class="title">TerminationPort</span>;</span>                          <span class="comment">//0x21c</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> _<span class="title">ETHREAD</span>* <span class="title">ReaperLink</span>;</span>                                        <span class="comment">//0x21c</span></span><br><span class="line">        VOID* KeyedWaitValue;                                               <span class="comment">//0x21c</span></span><br><span class="line">    &#125;;</span><br><span class="line">    ULONG ActiveTimerListLock;                                              <span class="comment">//0x220</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">ActiveTimerListHead</span>;</span>                                 <span class="comment">//0x224</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">CLIENT_ID</span> <span class="title">Cid</span>;</span>                                                  <span class="comment">//0x22c</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> _<span class="title">KSEMAPHORE</span> <span class="title">KeyedWaitSemaphore</span>;</span>                              <span class="comment">//0x234</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> _<span class="title">KSEMAPHORE</span> <span class="title">AlpcWaitSemaphore</span>;</span>                               <span class="comment">//0x234</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">PS_CLIENT_SECURITY_CONTEXT</span> <span class="title">ClientSecurity</span>;</span>                       <span class="comment">//0x248</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">IrpList</span>;</span>                                             <span class="comment">//0x24c</span></span><br><span class="line">    ULONG TopLevelIrp;                                                      <span class="comment">//0x254</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">DEVICE_OBJECT</span>* <span class="title">DeviceToVerify</span>;</span>                                  <span class="comment">//0x258</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">PSP_CPU_QUOTA_APC</span>* <span class="title">CpuQuotaApc</span>;</span>                                  <span class="comment">//0x25c</span></span><br><span class="line">    VOID* Win32StartAddress;                                                <span class="comment">//0x260</span></span><br><span class="line">    VOID* LegacyPowerObject;                                                <span class="comment">//0x264</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">ThreadListEntry</span>;</span>                                     <span class="comment">//0x268</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">EX_RUNDOWN_REF</span> <span class="title">RundownProtect</span>;</span>                                  <span class="comment">//0x270</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">EX_PUSH_LOCK</span> <span class="title">ThreadLock</span>;</span>                                        <span class="comment">//0x274</span></span><br><span class="line">    ULONG ReadClusterSize;                                                  <span class="comment">//0x278</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG MmLockOrdering;                                           <span class="comment">//0x27c</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        ULONG CrossThreadFlags;                                             <span class="comment">//0x280</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            ULONG Terminated:<span class="number">1</span>;                                             <span class="comment">//0x280</span></span><br><span class="line">            ULONG ThreadInserted:<span class="number">1</span>;                                         <span class="comment">//0x280</span></span><br><span class="line">            ULONG HideFromDebugger:<span class="number">1</span>;                                       <span class="comment">//0x280</span></span><br><span class="line">            ULONG ActiveImpersonationInfo:<span class="number">1</span>;                                <span class="comment">//0x280</span></span><br><span class="line">            ULONG Reserved:<span class="number">1</span>;                                               <span class="comment">//0x280</span></span><br><span class="line">            ULONG HardErrorsAreDisabled:<span class="number">1</span>;                                  <span class="comment">//0x280</span></span><br><span class="line">            ULONG BreakOnTermination:<span class="number">1</span>;                                     <span class="comment">//0x280</span></span><br><span class="line">            ULONG SkipCreationMsg:<span class="number">1</span>;                                        <span class="comment">//0x280</span></span><br><span class="line">            ULONG SkipTerminationMsg:<span class="number">1</span>;                                     <span class="comment">//0x280</span></span><br><span class="line">            ULONG CopyTokenOnOpen:<span class="number">1</span>;                                        <span class="comment">//0x280</span></span><br><span class="line">            ULONG ThreadIoPriority:<span class="number">3</span>;                                       <span class="comment">//0x280</span></span><br><span class="line">            ULONG ThreadPagePriority:<span class="number">3</span>;                                     <span class="comment">//0x280</span></span><br><span class="line">            ULONG RundownFail:<span class="number">1</span>;                                            <span class="comment">//0x280</span></span><br><span class="line">            ULONG NeedsWorkingSetAging:<span class="number">1</span>;                                   <span class="comment">//0x280</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        ULONG SameThreadPassiveFlags;                                       <span class="comment">//0x284</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            ULONG ActiveExWorker:<span class="number">1</span>;                                         <span class="comment">//0x284</span></span><br><span class="line">            ULONG ExWorkerCanWaitUser:<span class="number">1</span>;                                    <span class="comment">//0x284</span></span><br><span class="line">            ULONG MemoryMaker:<span class="number">1</span>;                                            <span class="comment">//0x284</span></span><br><span class="line">            ULONG ClonedThread:<span class="number">1</span>;                                           <span class="comment">//0x284</span></span><br><span class="line">            ULONG KeyedEventInUse:<span class="number">1</span>;                                        <span class="comment">//0x284</span></span><br><span class="line">            ULONG RateApcState:<span class="number">2</span>;                                           <span class="comment">//0x284</span></span><br><span class="line">            ULONG SelfTerminate:<span class="number">1</span>;                                          <span class="comment">//0x284</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        ULONG SameThreadApcFlags;                                           <span class="comment">//0x288</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            UCHAR Spare:<span class="number">1</span>;                                                  <span class="comment">//0x288</span></span><br><span class="line">            <span class="keyword">volatile</span> UCHAR StartAddressInvalid:<span class="number">1</span>;                           <span class="comment">//0x288</span></span><br><span class="line">            UCHAR EtwPageFaultCalloutActive:<span class="number">1</span>;                              <span class="comment">//0x288</span></span><br><span class="line">            UCHAR OwnsProcessWorkingSetExclusive:<span class="number">1</span>;                         <span class="comment">//0x288</span></span><br><span class="line">            UCHAR OwnsProcessWorkingSetShared:<span class="number">1</span>;                            <span class="comment">//0x288</span></span><br><span class="line">            UCHAR OwnsSystemCacheWorkingSetExclusive:<span class="number">1</span>;                     <span class="comment">//0x288</span></span><br><span class="line">            UCHAR OwnsSystemCacheWorkingSetShared:<span class="number">1</span>;                        <span class="comment">//0x288</span></span><br><span class="line">            UCHAR OwnsSessionWorkingSetExclusive:<span class="number">1</span>;                         <span class="comment">//0x288</span></span><br><span class="line">            UCHAR OwnsSessionWorkingSetShared:<span class="number">1</span>;                            <span class="comment">//0x289</span></span><br><span class="line">            UCHAR OwnsProcessAddressSpaceExclusive:<span class="number">1</span>;                       <span class="comment">//0x289</span></span><br><span class="line">            UCHAR OwnsProcessAddressSpaceShared:<span class="number">1</span>;                          <span class="comment">//0x289</span></span><br><span class="line">            UCHAR SuppressSymbolLoad:<span class="number">1</span>;                                     <span class="comment">//0x289</span></span><br><span class="line">            UCHAR Prefetching:<span class="number">1</span>;                                            <span class="comment">//0x289</span></span><br><span class="line">            UCHAR OwnsDynamicMemoryShared:<span class="number">1</span>;                                <span class="comment">//0x289</span></span><br><span class="line">            UCHAR OwnsChangeControlAreaExclusive:<span class="number">1</span>;                         <span class="comment">//0x289</span></span><br><span class="line">            UCHAR OwnsChangeControlAreaShared:<span class="number">1</span>;                            <span class="comment">//0x289</span></span><br><span class="line">            UCHAR OwnsPagedPoolWorkingSetExclusive:<span class="number">1</span>;                       <span class="comment">//0x28a</span></span><br><span class="line">            UCHAR OwnsPagedPoolWorkingSetShared:<span class="number">1</span>;                          <span class="comment">//0x28a</span></span><br><span class="line">            UCHAR OwnsSystemPtesWorkingSetExclusive:<span class="number">1</span>;                      <span class="comment">//0x28a</span></span><br><span class="line">            UCHAR OwnsSystemPtesWorkingSetShared:<span class="number">1</span>;                         <span class="comment">//0x28a</span></span><br><span class="line">            UCHAR TrimTrigger:<span class="number">2</span>;                                            <span class="comment">//0x28a</span></span><br><span class="line">            UCHAR Spare1:<span class="number">2</span>;                                                 <span class="comment">//0x28a</span></span><br><span class="line">            UCHAR PriorityRegionActive;                                     <span class="comment">//0x28b</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    UCHAR CacheManagerActive;                                               <span class="comment">//0x28c</span></span><br><span class="line">    UCHAR DisablePageFaultClustering;                                       <span class="comment">//0x28d</span></span><br><span class="line">    UCHAR ActiveFaultCount;                                                 <span class="comment">//0x28e</span></span><br><span class="line">    UCHAR LockOrderState;                                                   <span class="comment">//0x28f</span></span><br><span class="line">    ULONG AlpcMessageId;                                                    <span class="comment">//0x290</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        VOID* AlpcMessage;                                                  <span class="comment">//0x294</span></span><br><span class="line">        ULONG AlpcReceiveAttributeSet;                                      <span class="comment">//0x294</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">AlpcWaitListEntry</span>;</span>                                   <span class="comment">//0x298</span></span><br><span class="line">    ULONG CacheManagerCount;                                                <span class="comment">//0x2a0</span></span><br><span class="line">    ULONG IoBoostCount;                                                     <span class="comment">//0x2a4</span></span><br><span class="line">    ULONG IrpListLock;                                                      <span class="comment">//0x2a8</span></span><br><span class="line">    VOID* ReservedForSynchTracking;                                         <span class="comment">//0x2ac</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">SINGLE_LIST_ENTRY</span> <span class="title">CmCallbackListHead</span>;</span>                           <span class="comment">//0x2b0</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>+0 Tcb：KTHREAD成员，见下文。</li>
<li>+218 StartAddress：线程函数起始地址。</li>
<li>+22C Cid：当前线程的线程ID。为_CLIENT_ID结构，包含了线程ID和所属的进程ID。</li>
<li>+268 ThreadListEntry：当前进程内所有线程的双向链表。</li>
</ul>
<h2 id="KTHREAD结构"><a href="#KTHREAD结构" class="headerlink" title="KTHREAD结构"></a>KTHREAD结构</h2><p>与进程一样，第一个成员为KTHREAD结构。</p>
<p>KTHREAD结构成员列表：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//0x200 bytes (sizeof)</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">KTHREAD</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">DISPATCHER_HEADER</span> <span class="title">Header</span>;</span>                                       <span class="comment">//0x0</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONGLONG CycleTime;                                           <span class="comment">//0x10</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONG HighCycleTime;                                           <span class="comment">//0x18</span></span><br><span class="line">    ULONGLONG QuantumTarget;                                                <span class="comment">//0x20</span></span><br><span class="line">    VOID* InitialStack;                                                     <span class="comment">//0x28</span></span><br><span class="line">    VOID* <span class="keyword">volatile</span> StackLimit;                                              <span class="comment">//0x2c</span></span><br><span class="line">    VOID* KernelStack;                                                      <span class="comment">//0x30</span></span><br><span class="line">    ULONG ThreadLock;                                                       <span class="comment">//0x34</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> _<span class="title">KWAIT_STATUS_REGISTER</span> <span class="title">WaitRegister</span>;</span>                              <span class="comment">//0x38</span></span><br><span class="line">    <span class="keyword">volatile</span> UCHAR Running;                                                 <span class="comment">//0x39</span></span><br><span class="line">    UCHAR Alerted[<span class="number">2</span>];                                                       <span class="comment">//0x3a</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            ULONG KernelStackResident:<span class="number">1</span>;                                    <span class="comment">//0x3c</span></span><br><span class="line">            ULONG ReadyTransition:<span class="number">1</span>;                                        <span class="comment">//0x3c</span></span><br><span class="line">            ULONG ProcessReadyQueue:<span class="number">1</span>;                                      <span class="comment">//0x3c</span></span><br><span class="line">            ULONG WaitNext:<span class="number">1</span>;                                               <span class="comment">//0x3c</span></span><br><span class="line">            ULONG SystemAffinityActive:<span class="number">1</span>;                                   <span class="comment">//0x3c</span></span><br><span class="line">            ULONG Alertable:<span class="number">1</span>;                                              <span class="comment">//0x3c</span></span><br><span class="line">            ULONG GdiFlushActive:<span class="number">1</span>;                                         <span class="comment">//0x3c</span></span><br><span class="line">            ULONG UserStackWalkActive:<span class="number">1</span>;                                    <span class="comment">//0x3c</span></span><br><span class="line">            ULONG ApcInterruptRequest:<span class="number">1</span>;                                    <span class="comment">//0x3c</span></span><br><span class="line">            ULONG ForceDeferSchedule:<span class="number">1</span>;                                     <span class="comment">//0x3c</span></span><br><span class="line">            ULONG QuantumEndMigrate:<span class="number">1</span>;                                      <span class="comment">//0x3c</span></span><br><span class="line">            ULONG UmsDirectedSwitchEnable:<span class="number">1</span>;                                <span class="comment">//0x3c</span></span><br><span class="line">            ULONG TimerActive:<span class="number">1</span>;                                            <span class="comment">//0x3c</span></span><br><span class="line">            ULONG SystemThread:<span class="number">1</span>;                                           <span class="comment">//0x3c</span></span><br><span class="line">            ULONG Reserved:<span class="number">18</span>;                                              <span class="comment">//0x3c</span></span><br><span class="line">        &#125;;</span><br><span class="line">        LONG MiscFlags;                                                     <span class="comment">//0x3c</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> _<span class="title">KAPC_STATE</span> <span class="title">ApcState</span>;</span>                                        <span class="comment">//0x40</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            UCHAR ApcStateFill[<span class="number">23</span>];                                         <span class="comment">//0x40</span></span><br><span class="line">            CHAR Priority;                                                  <span class="comment">//0x57</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">volatile</span> ULONG NextProcessor;                                           <span class="comment">//0x58</span></span><br><span class="line">    <span class="keyword">volatile</span> ULONG DeferredProcessor;                                       <span class="comment">//0x5c</span></span><br><span class="line">    ULONG ApcQueueLock;                                                     <span class="comment">//0x60</span></span><br><span class="line">    ULONG ContextSwitches;                                                  <span class="comment">//0x64</span></span><br><span class="line">    <span class="keyword">volatile</span> UCHAR State;                                                   <span class="comment">//0x68</span></span><br><span class="line">    CHAR NpxState;                                                          <span class="comment">//0x69</span></span><br><span class="line">    UCHAR WaitIrql;                                                         <span class="comment">//0x6a</span></span><br><span class="line">    CHAR WaitMode;                                                          <span class="comment">//0x6b</span></span><br><span class="line">    <span class="keyword">volatile</span> LONG WaitStatus;                                               <span class="comment">//0x6c</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KWAIT_BLOCK</span>* <span class="title">WaitBlockList</span>;</span>                                     <span class="comment">//0x70</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">WaitListEntry</span>;</span>                                   <span class="comment">//0x74</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> _<span class="title">SINGLE_LIST_ENTRY</span> <span class="title">SwapListEntry</span>;</span>                            <span class="comment">//0x74</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KQUEUE</span>* <span class="title">volatile</span> <span class="title">Queue</span>;</span>                                         <span class="comment">//0x7c</span></span><br><span class="line">    ULONG WaitTime;                                                         <span class="comment">//0x80</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            SHORT KernelApcDisable;                                         <span class="comment">//0x84</span></span><br><span class="line">            SHORT SpecialApcDisable;                                        <span class="comment">//0x86</span></span><br><span class="line">        &#125;;</span><br><span class="line">        ULONG CombinedApcDisable;                                           <span class="comment">//0x84</span></span><br><span class="line">    &#125;;</span><br><span class="line">    VOID* Teb;                                                              <span class="comment">//0x88</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KTIMER</span> <span class="title">Timer</span>;</span>                                                   <span class="comment">//0x90</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            <span class="keyword">volatile</span> ULONG AutoAlignment:<span class="number">1</span>;                                 <span class="comment">//0xb8</span></span><br><span class="line">            <span class="keyword">volatile</span> ULONG DisableBoost:<span class="number">1</span>;                                  <span class="comment">//0xb8</span></span><br><span class="line">            <span class="keyword">volatile</span> ULONG EtwStackTraceApc1Inserted:<span class="number">1</span>;                     <span class="comment">//0xb8</span></span><br><span class="line">            <span class="keyword">volatile</span> ULONG EtwStackTraceApc2Inserted:<span class="number">1</span>;                     <span class="comment">//0xb8</span></span><br><span class="line">            <span class="keyword">volatile</span> ULONG CalloutActive:<span class="number">1</span>;                                 <span class="comment">//0xb8</span></span><br><span class="line">            <span class="keyword">volatile</span> ULONG ApcQueueable:<span class="number">1</span>;                                  <span class="comment">//0xb8</span></span><br><span class="line">            <span class="keyword">volatile</span> ULONG EnableStackSwap:<span class="number">1</span>;                               <span class="comment">//0xb8</span></span><br><span class="line">            <span class="keyword">volatile</span> ULONG GuiThread:<span class="number">1</span>;                                     <span class="comment">//0xb8</span></span><br><span class="line">            <span class="keyword">volatile</span> ULONG UmsPerformingSyscall:<span class="number">1</span>;                          <span class="comment">//0xb8</span></span><br><span class="line">            <span class="keyword">volatile</span> ULONG VdmSafe:<span class="number">1</span>;                                       <span class="comment">//0xb8</span></span><br><span class="line">            <span class="keyword">volatile</span> ULONG UmsDispatched:<span class="number">1</span>;                                 <span class="comment">//0xb8</span></span><br><span class="line">            <span class="keyword">volatile</span> ULONG ReservedFlags:<span class="number">21</span>;                                <span class="comment">//0xb8</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">volatile</span> LONG ThreadFlags;                                          <span class="comment">//0xb8</span></span><br><span class="line">    &#125;;</span><br><span class="line">    VOID* ServiceTable;                                                     <span class="comment">//0xbc</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KWAIT_BLOCK</span> <span class="title">WaitBlock</span>[4];</span>                                       <span class="comment">//0xc0</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">QueueListEntry</span>;</span>                                      <span class="comment">//0x120</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KTRAP_FRAME</span>* <span class="title">TrapFrame</span>;</span>                                         <span class="comment">//0x128</span></span><br><span class="line">    VOID* FirstArgument;                                                    <span class="comment">//0x12c</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        VOID* CallbackStack;                                                <span class="comment">//0x130</span></span><br><span class="line">        ULONG CallbackDepth;                                                <span class="comment">//0x130</span></span><br><span class="line">    &#125;;</span><br><span class="line">    UCHAR ApcStateIndex;                                                    <span class="comment">//0x134</span></span><br><span class="line">    CHAR BasePriority;                                                      <span class="comment">//0x135</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        CHAR PriorityDecrement;                                             <span class="comment">//0x136</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            UCHAR ForegroundBoost:<span class="number">4</span>;                                        <span class="comment">//0x136</span></span><br><span class="line">            UCHAR UnusualBoost:<span class="number">4</span>;                                           <span class="comment">//0x136</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    UCHAR Preempted;                                                        <span class="comment">//0x137</span></span><br><span class="line">    UCHAR AdjustReason;                                                     <span class="comment">//0x138</span></span><br><span class="line">    CHAR AdjustIncrement;                                                   <span class="comment">//0x139</span></span><br><span class="line">    CHAR PreviousMode;                                                      <span class="comment">//0x13a</span></span><br><span class="line">    CHAR Saturation;                                                        <span class="comment">//0x13b</span></span><br><span class="line">    ULONG SystemCallNumber;                                                 <span class="comment">//0x13c</span></span><br><span class="line">    ULONG FreezeCount;                                                      <span class="comment">//0x140</span></span><br><span class="line">    <span class="keyword">volatile</span> <span class="class"><span class="keyword">struct</span> _<span class="title">GROUP_AFFINITY</span> <span class="title">UserAffinity</span>;</span>                           <span class="comment">//0x144</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KPROCESS</span>* <span class="title">Process</span>;</span>                                              <span class="comment">//0x150</span></span><br><span class="line">    <span class="keyword">volatile</span> <span class="class"><span class="keyword">struct</span> _<span class="title">GROUP_AFFINITY</span> <span class="title">Affinity</span>;</span>                               <span class="comment">//0x154</span></span><br><span class="line">    ULONG IdealProcessor;                                                   <span class="comment">//0x160</span></span><br><span class="line">    ULONG UserIdealProcessor;                                               <span class="comment">//0x164</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KAPC_STATE</span>* <span class="title">ApcStatePointer</span>[2];</span>                                 <span class="comment">//0x168</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> _<span class="title">KAPC_STATE</span> <span class="title">SavedApcState</span>;</span>                                   <span class="comment">//0x170</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            UCHAR SavedApcStateFill[<span class="number">23</span>];                                    <span class="comment">//0x170</span></span><br><span class="line">            UCHAR WaitReason;                                               <span class="comment">//0x187</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    CHAR SuspendCount;                                                      <span class="comment">//0x188</span></span><br><span class="line">    CHAR Spare1;                                                            <span class="comment">//0x189</span></span><br><span class="line">    UCHAR OtherPlatformFill;                                                <span class="comment">//0x18a</span></span><br><span class="line">    VOID* <span class="keyword">volatile</span> Win32Thread;                                             <span class="comment">//0x18c</span></span><br><span class="line">    VOID* StackBase;                                                        <span class="comment">//0x190</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> _<span class="title">KAPC</span> <span class="title">SuspendApc</span>;</span>                                            <span class="comment">//0x194</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            UCHAR SuspendApcFill0[<span class="number">1</span>];                                       <span class="comment">//0x194</span></span><br><span class="line">            UCHAR ResourceIndex;                                            <span class="comment">//0x195</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            UCHAR SuspendApcFill1[<span class="number">3</span>];                                       <span class="comment">//0x194</span></span><br><span class="line">            UCHAR QuantumReset;                                             <span class="comment">//0x197</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            UCHAR SuspendApcFill2[<span class="number">4</span>];                                       <span class="comment">//0x194</span></span><br><span class="line">            ULONG KernelTime;                                               <span class="comment">//0x198</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            UCHAR SuspendApcFill3[<span class="number">36</span>];                                      <span class="comment">//0x194</span></span><br><span class="line">            <span class="class"><span class="keyword">struct</span> _<span class="title">KPRCB</span>* <span class="title">volatile</span> <span class="title">WaitPrcb</span>;</span>                               <span class="comment">//0x1b8</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            UCHAR SuspendApcFill4[<span class="number">40</span>];                                      <span class="comment">//0x194</span></span><br><span class="line">            VOID* LegoData;                                                 <span class="comment">//0x1bc</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            UCHAR SuspendApcFill5[<span class="number">47</span>];                                      <span class="comment">//0x194</span></span><br><span class="line">            UCHAR LargeStack;                                               <span class="comment">//0x1c3</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    ULONG UserTime;                                                         <span class="comment">//0x1c4</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> _<span class="title">KSEMAPHORE</span> <span class="title">SuspendSemaphore</span>;</span>                                <span class="comment">//0x1c8</span></span><br><span class="line">        UCHAR SuspendSemaphorefill[<span class="number">20</span>];                                     <span class="comment">//0x1c8</span></span><br><span class="line">    &#125;;</span><br><span class="line">    ULONG SListFaultCount;                                                  <span class="comment">//0x1dc</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">ThreadListEntry</span>;</span>                                     <span class="comment">//0x1e0</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> <span class="title">MutantListHead</span>;</span>                                      <span class="comment">//0x1e8</span></span><br><span class="line">    VOID* SListFaultAddress;                                                <span class="comment">//0x1f0</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">KTHREAD_COUNTERS</span>* <span class="title">ThreadCounters</span>;</span>                               <span class="comment">//0x1f4</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">XSTATE_SAVE</span>* <span class="title">XStateSave</span>;</span>                                        <span class="comment">//0x1f8</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>+0 Header：可等待对象头部。</li>
<li>+28 InitialStack：线程切换相关。当前线程的栈底。栈底-29C是TrapFrame结构首地址。</li>
<li>+2C StackLimit：线程切换相关。当前线程的最大栈顶。ESP不能小于这个值。</li>
<li>+30 KernelStack：线程切换相关。线程切换时，存储当前线程切换时的ESP，被切换回来时，从这里恢复ESP。</li>
<li>+39 Running：线程状态，正在运行中为1，否则为0。</li>
<li>+3A Alerted：可警惕性。APC相关，后续APC章节学习。</li>
<li>+3C MiscFlags：<ul>
<li>KernelStackResident：堆栈可扩展位。为1时，线程内核堆栈可以被扩大。0时无法扩大。</li>
<li>SystemThread：为1时，该线程为内核线程，否则为用户线程。</li>
</ul>
</li>
<li>+40 ApcState：APC相关，后续APC章节学习。</li>
<li>+57 Priority：当前线程的优先级。如存储11，则优先级为11，当前线程存储在第11个就绪链表中。优先级数字越大，优先级越低。默认线程优先级为8，存储在第8个就绪链表中。</li>
<li>+60 ApcQueueLock：APC相关，后续APC章节学习。</li>
<li>+64 ContextSwitches：当前线程切换了多少次。</li>
<li>+68 State：线程状态。就绪、等待、运行等。</li>
<li>+88 Teb：3环的TEB。</li>
<li>+BC ServiceTable：系统服务表地址，系统调用章节已学过。</li>
<li>+C0 WaitBlock：当前线程正在等待的对象。</li>
<li>+128 TrapFrame：TrapFrame结构，进0环时保存3环寄存器的值，系统调用章节已学过。</li>
<li>+135 BasePriority：线程基础优先级。这个值就是所属进程的BasePriority值。</li>
<li>+13A PreviousMode：先前模式。一些内核函数会判断这个值。</li>
<li>+150 Process：该线程的父进程（创建该线程的进程）。</li>
<li>+168 ApcStatePointer：APC相关，后续APC章节学习。</li>
<li>+170 SavedApcState：APC相关，后续APC章节学习。</li>
<li>+18C Win32Thread：win32线程，如果该线程是UI图形线程，就会多一个win32线程结构体。</li>
<li>+1E0 ThreadListEntry：当前进程所有线程的双向链表。</li>
</ul>
<h1 id="4-OBJECT-HEADER"><a href="#4-OBJECT-HEADER" class="headerlink" title="4.OBJECT_HEADER"></a>4.OBJECT_HEADER</h1><p>每一个内核对象都有一个OBJECT_HEADER结构，大小为0x18。将某个内核对象地址-0x18就是OBJECT_HEADER结构地址。</p>
<p>OBJECT_HEADER结构成员列表：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">nt!_OBJECT_HEADER</span><br><span class="line">   +0x000 PointerCount     : Int4B</span><br><span class="line">   +0x004 HandleCount      : Int4B</span><br><span class="line">   +0x004 NextToFree       : Ptr32 Void</span><br><span class="line">   +0x008 Lock             : _EX_PUSH_LOCK</span><br><span class="line">   +0x00c TypeIndex        : UChar</span><br><span class="line">   +0x00d TraceFlags       : UChar</span><br><span class="line">   +0x00e InfoMask         : UChar</span><br><span class="line">   +0x00f Flags            : UChar</span><br><span class="line">   +0x010 ObjectCreateInfo : Ptr32 _OBJECT_CREATE_INFORMATION</span><br><span class="line">   +0x010 QuotaBlockCharged : Ptr32 Void</span><br><span class="line">   +0x014 SecurityDescriptor : Ptr32 Void</span><br><span class="line">   +0x018 Body             : _QUAD</span><br></pre></td></tr></table></figure>

<ul>
<li>PointerCount：对应的内核对象被使用了多少次。如调用ObXXXX函数都会将该值+1。该值为0时，对应的内核对象就会被释放。</li>
<li>HandleCount：句柄引用。</li>
<li>TypeIndex：对应的内核对象的类型。</li>
<li>Flags：详细作用未知。当此处的值被置为4时（对应的对象为进程对象时），对应的进程被保护，无法打开、附加。且不影响进程功能。仅对3环起作用。</li>
</ul>
<h1 id="5-线程链表"><a href="#5-线程链表" class="headerlink" title="5.线程链表"></a>5.线程链表</h1><p>线程大体上可分为3种状态：等待、正在运行、就绪。系统上的所有未处于正在运行状态的线程都被存储在两种链表中：等待链表+就绪链表。</p>
<h2 id="等待链表"><a href="#等待链表" class="headerlink" title="等待链表"></a>等待链表</h2><p>全局变量KiWaitListHead是一个双向链表的头部，里面是所有等待执行的线程的ETHREAD结构，每个核都有一个等待链表。链表中每个节点指向ETHREAD中的KTHREAD-&gt;WaitListEntry。</p>
<p>当调用Sleep、WaitForSingleObject一类的等待函数时，该线程会被加入到这个链表中。</p>
<h2 id="就绪链表（调度链表）"><a href="#就绪链表（调度链表）" class="headerlink" title="就绪链表（调度链表）"></a>就绪链表（调度链表）</h2><p>所有就绪的线程都会存储在就绪链表中，共有32个就绪链表（32位），所有核共享这32个链表，每个链表对应一个优先级（0~31）。全局变量KiDispatcherReadyListHead存储了这32个链表的起始位置。</p>
<h2 id="扩展：进程、线程遍历"><a href="#扩展：进程、线程遍历" class="headerlink" title="扩展：进程、线程遍历"></a>扩展：进程、线程遍历</h2><p>操作系统中所有的线程 &#x3D; 所有核中等待链表中的所有线程 + 32个就绪链表中所有线程 + 所有核的KPCR中正在运行的线程。</p>
<p>而通过遍历线程可以找到每个线程所属的进程。即使断链也无法阻挡这种遍历。</p>
<h1 id="6-线程切换-模拟版"><a href="#6-线程切换-模拟版" class="headerlink" title="6.线程切换-模拟版"></a>6.线程切换-模拟版</h1><p>在逆向windows线程切换逻辑之前，先自己写一个模拟的线程切换代码，感受下线程切换的大体思路。</p>
<p>滴水模拟线程切换源码：<a target="_blank" rel="noopener" href="https://wwi.lanzoui.com/iKbe0vdd95g">https://wwi.lanzoui.com/iKbe0vdd95g</a></p>
<p>首先初始化四个线程。然后观察初始化函数RegisterGMThread。</p>
<p><img src="/.com//4.png"></p>
<h2 id="RegisterGMThread"><a href="#RegisterGMThread" class="headerlink" title="RegisterGMThread"></a>RegisterGMThread</h2><p>代码中定义了一个线程池，是一个全局数组变量，每个元素都是自定义的线程结构体。</p>
<p><img src="/.com//5.png"></p>
<p><img src="/.com//6.png"></p>
<p>initGMThread函数里首先为新线程分配一个堆栈空间。</p>
<p><img src="/.com//7.png"></p>
<p>然后向分配出来的堆栈空间里压入了几个初始值，这些值皆是线程切换时要用到的数值，在创建完第一次被切换时这些值会作为初始值参与线程切换。而其中的push 9作用只是为了占用4个字节。这里需要配合后文线程切换函数才能体会到这4字节的作用。</p>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 jaytp@qq.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">💰</a>
</p>






    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2016-2023 answer77
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>Help us with donation</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">alipay</label></span><span><label><input type="radio" name="pay" value="weixin">weixin</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 672px;
    }
    .nav.fullscreen {
        margin-left: -672px;
    }
    .nav-left {
        width: 250px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 572px;
        }
        .nav.fullscreen {
            margin-left: -572px;
        }
        .nav-left {
            width: 180px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 572px;
            margin-left: -572px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    #post {
        background: url(/img/3.png);
    }
    
    
    #post .index {
        background: url(/img/3.png);
    }
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.5;
        background: url("/img/2.png");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>







</html>
